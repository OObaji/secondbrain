<!DOCTYPE html>
<html lang="en" class="overflow-x-hidden">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LifeOS - Second Brain</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        zinc: {
                            850: '#1f1f22',
                            950: '#09090b',
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            -webkit-font-smoothing: antialiased; 
            touch-action: manipulation;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .landing-gradient { background: linear-gradient(135deg, #09090b 0%, #18181b 100%); }
        .timer-progress { transition: stroke-dashoffset 1s linear; }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-100 min-h-screen overflow-y-auto">
    <div id="root"></div>

    <!-- Application Logic -->
    <script type="module">
        import React, { useState, useEffect, useRef } from "https://esm.sh/react@18.2.0";
        import { createRoot } from "https://esm.sh/react-dom@18.2.0/client";
        import { 
            Layout, Home, BookOpen, Target, PenTool, Settings, Search, Bell, Plus, 
            MoreHorizontal, CheckCircle2, Clock, ArrowRight, Brain, Layers, 
            Calendar as CalendarIcon, ChevronRight, Sun, Moon, Filter, Zap, Coffee, 
            Video, MapPin, RefreshCw, MoreVertical, Lightbulb, Sparkles, Trash2, 
            Sprout, Briefcase, DollarSign, Move, Eraser, Palette, MousePointer2, 
            Trophy, Flag, TrendingUp, Award, Crosshair, Star, Bookmark, Book, 
            GraduationCap, Wallet, Building, Users, ExternalLink, Link as LinkIcon, 
            PlayCircle, Film, Music, Gamepad2, MonitorPlay, Headphones, Tv, 
            MessageSquare, AlertCircle, Folder, Minus, CalendarDays, LogOut, Lock, 
            Fingerprint, Delete, KeyRound, ShieldQuestion, RotateCcw, Menu, X, Save, Edit3, Wifi, WifiOff, Database,
            Timer, Play, Pause, Wrench, File, CreditCard, Coins, Heart, Activity, Scissors, Share2, Mail, Archive, Image,
            Cloud, CloudRain, CloudSun, CloudSnow, CloudLightning, Thermometer,
            List, Grid, Columns, Utensils, FileText, Trash, ShieldAlert, Flame, Volume2, ChevronLeft,
            ListTodo, ArrowUpRight, CheckSquare, Flower2, Dumbbell, Github, Bot, Newspaper, QrCode,
            Waves, Wind, Mountain, Footprints, Ban, ShieldCheck, Milestone, User, LogIn, ArrowLeft, Info,
            Eye, EyeOff, Hourglass, AlertTriangle, Check
        } from "https://esm.sh/lucide-react@0.344.0?deps=react@18.2.0";

        // --- SUPABASE IMPORT ---
        import { createClient } from 'https://esm.sh/@supabase/supabase-js@2.39.3';

        // --- CONFIGURATION ---
        const SUPABASE_URL = "https://zcyzorbmlmcvjsgqlbmp.supabase.co"; 
        const SUPABASE_ANON_KEY = "sb_publishable_6GuAbqCKLI0QOMhPrLHWag_ke5ahM8R";
        
        let supabase = null;
        let isSupabaseConfigured = false;

        if (SUPABASE_URL && SUPABASE_ANON_KEY) {
            try {
                supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                isSupabaseConfigured = true;
            } catch(e) { 
                console.error("Supabase Init Failed", e);
            }
        }

        // --- LOCAL AUTH SIMULATION (Fallback) ---
        const LocalAuth = {
            login: (email, password) => {
                const users = JSON.parse(localStorage.getItem('lifeos_local_db_users') || '{}');
                const user = users[email.toLowerCase()];
                if (!user) throw new Error("User not found locally. Please create an account.");
                if (user.password !== password) throw new Error("Incorrect password.");
                return { email: user.email, id: user.uid, isLocal: true, user_metadata: { name: user.displayName || user.email.split('@')[0] } };
            },
            signup: (email, password) => {
                const users = JSON.parse(localStorage.getItem('lifeos_local_db_users') || '{}');
                if (users[email.toLowerCase()]) throw new Error("Account already exists. Please sign in.");
                const uid = 'local_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const displayName = email.split('@')[0];
                users[email.toLowerCase()] = { email, password, uid, displayName };
                localStorage.setItem('lifeos_local_db_users', JSON.stringify(users));
                return { email, id: uid, isLocal: true, user_metadata: { name: displayName } };
            }
        };

        // --- DATA CONSTANTS ---
        const DEFAULT_GOALS_DATA = {
            mission: "Reshape my life by achieving financial stability, building iron discipline, and gaining clear direction for my future.",
            phases: {
                phase1: [
                    { id: 'p1_1', text: "Clear unsecured debt (£0)", completed: false },
                    { id: 'p1_2', text: "School fees paid in full", completed: false },
                    { id: 'p1_3', text: "Expenses minimized (Survival mode)", completed: false }
                ],
                phase2: [], phase3: []
            },
            quarters: {
                q1: [
                    { id: 'q1_1', text: "Establish strict yearly budget (Separate from debt)", completed: false },
                    { id: 'q1_2', text: "Keep sleep schedule consistent", completed: false },
                    { id: 'q1_3', text: "Complete Web Innovation Project", completed: false },
                    { id: 'q1_4', text: "Complete Dissertation Log 2 & 3", completed: false },
                    { id: 'q1_5', text: "Complete Machine Learning Project", completed: false },
                    { id: 'q1_6', text: "Study & Sit for Cyber Security Exam", completed: false },
                    { id: 'q1_7', text: "Start & Lock-in Dissertation", completed: false },
                    { id: 'q1_8', text: "Pay towards Tuition Fees", completed: false },
                    { id: 'q1_9', text: "Get someone to take over tenancy for Liverpool apartment", completed: false },
                    { id: 'q1_10', text: "Never miss a workout session (4 days weekly)", completed: false },
                    { id: 'q1_11', text: "Never miss morning run", completed: false },
                    { id: 'q1_12', text: "Add a database to LifeOS app", completed: false },
                    { id: 'q1_13', text: "Master systems (Journal, LifeOS, Calendar, Fitness)", completed: false },
                    { id: 'q1_14', text: "Daily Bible & Prayer (Even 1 verse counts)", completed: false }
                ],
                q2: [], q3: [], q4: []
            },
            execution: {
                weekly: [
                    { id: 'w1', text: "Income Action (Extra Shift/Task)", completed: false },
                    { id: 'w2', text: "5-10 Hours Skill Acquisition", completed: false },
                    { id: 'w3', text: "Sunday Sermon & Study", completed: false },
                    { id: 'w4', text: "4-6 Workouts (Hypertrophy)", completed: false },
                    { id: 'w5', text: "Sunday Review (15 Mins)", completed: false }
                ],
                daily: [
                    { id: 'd1', text: "Wake & Sleep Consistent", completed: false },
                    { id: 'd2', text: "Pray Morning & Night (2x)", completed: false },
                    { id: 'd3', text: "Bible & Sermon (30m)", completed: false },
                    { id: 'd4', text: "Train or Move Body", completed: false },
                    { id: 'd5', text: "Night Reflection (The 'Why')", completed: false }
                ]
            }
        };

        const DEFAULT_MEALS = [
            { day: 'Monday', type: 'Breakfast', text: 'Oats + milk\n1 banana\n1 scoop protein powder' },
            { day: 'Monday', type: 'Lunch', text: 'Chicken stew\nWhite rice\n½ avocado' },
            { day: 'Monday', type: 'Snack', text: 'Greek yoghurt + apple' },
            { day: 'Monday', type: 'Dinner', text: 'Spaghetti + grilled chicken breast\n(Night: Milo + milk)' },
            { day: 'Tuesday', type: 'Breakfast', text: '3 eggs (boiled/scrambled)\nBread + peanut butter\nGrapes' },
            { day: 'Tuesday', type: 'Lunch', text: 'Jollof rice\nChicken thigh' },
            { day: 'Tuesday', type: 'Snack', text: 'Protein shake' },
            { day: 'Tuesday', type: 'Dinner', text: 'Sardines\nBoiled potatoes' },
            { day: 'Wednesday', type: 'Breakfast', text: 'Cereal + milk\nBanana' },
            { day: 'Wednesday', type: 'Lunch', text: 'Chicken breast\nRice\nAvocado' },
            { day: 'Wednesday', type: 'Snack', text: 'Greek yoghurt + grapes' },
            { day: 'Wednesday', type: 'Dinner', text: 'Spaghetti + chicken stew' },
            { day: 'Thursday', type: 'Breakfast', text: 'Oats + milk\nApple\n1 scoop protein' },
            { day: 'Thursday', type: 'Lunch', text: 'Chicken stew\nRice' },
            { day: 'Thursday', type: 'Snack', text: 'Bread + peanut butter' },
            { day: 'Thursday', type: 'Dinner', text: 'Sardines\nPotatoes' },
            { day: 'Friday', type: 'Breakfast', text: '3 eggs\nBread + jam\nBanana' },
            { day: 'Friday', type: 'Lunch', text: 'Jollof rice\nChicken breast' },
            { day: 'Friday', type: 'Snack', text: 'Greek yoghurt' },
            { day: 'Friday', type: 'Dinner', text: 'Pasta + grilled chicken thigh' },
            { day: 'Saturday', type: 'Breakfast', text: 'Cereal + milk\nGrapes' },
            { day: 'Saturday', type: 'Lunch', text: 'Chicken thigh\nRice + avocado' },
            { day: 'Saturday', type: 'Snack', text: 'Protein shake' },
            { day: 'Saturday', type: 'Dinner', text: 'Eggs (omelette)\nBread' },
            { day: 'Sunday', type: 'Breakfast', text: 'Oats + milk\nBanana' },
            { day: 'Sunday', type: 'Lunch', text: 'Rice + sardines' },
            { day: 'Sunday', type: 'Snack', text: 'Greek yoghurt + apple' },
            { day: 'Sunday', type: 'Dinner', text: 'Chicken stew\nPotatoes' }
        ];

        const WORKOUT_PLAN = [
            { id: 'gym1', title: "Day 1: Chest & Triceps", icon: Flame, color: "text-rose-500", warmup: ["5min Treadmill", "Arm Circles"], exercises: [{ name: "Bench Press", sets: "4", reps: "8-10" }], finisher: "Pushups" },
            { id: 'gym2', title: "Day 2: Back & Biceps", icon: Activity, color: "text-blue-500", warmup: ["5min Rower"], exercises: [{ name: "Lat Pulldown", sets: "4", reps: "10-12" }], finisher: "Face Pulls" },
            { id: 'gym3', title: "Day 3: Legs", icon: Dumbbell, color: "text-emerald-500", warmup: ["Squats"], exercises: [{ name: "Barbell Squat", sets: "4", reps: "6-8" }], finisher: "Lunges" },
            { id: 'gym4', title: "Day 4: Shoulders", icon: Zap, color: "text-purple-500", warmup: ["Dislocations"], exercises: [{ name: "Overhead Press", sets: "4", reps: "8-10" }], finisher: "Planks" }
        ];
        const GYM_WORKOUT_PLAN = WORKOUT_PLAN;
        const HOME_WORKOUT_PLAN = WORKOUT_PLAN;

        const BIBLE_TOPICS = [
            { title: "Finance & Wealth", desc: "Stewardship & trust.", verses: ["Prov 22:7", "Matt 6:24"], chapters: ["Prov 3", "Matt 6"] },
            { title: "Anxiety & Peace", desc: "Finding rest.", verses: ["1 Pet 5:7", "John 14:27"], chapters: ["Phil 4", "Ps 23"] }
        ];

        const FOCUS_SOUNDS = [
            { id: 'rain', label: 'Rain', icon: CloudRain, url: 'https://assets.mixkit.co/active_storage/sfx/2515/2515-preview.mp3' },
            { id: 'fire', label: 'Fire', icon: Flame, url: 'https://assets.mixkit.co/active_storage/sfx/2513/2513-preview.mp3' },
            { id: 'lofi', label: 'Lofi', icon: Music, url: 'https://cdn.pixabay.com/audio/2022/11/22/audio_febc508520.mp3' }
        ];

        const DAILY_SPIRITUALITY = [
            { verse: "Joshua 1:9", text: "Be strong and courageous...", prayer: "Lord, grant me courage.", encouragement: "You are never alone." },
            { verse: "Jer 29:11", text: "Plans to prosper you...", prayer: "Help me trust Your timing.", encouragement: "Your future is bright." }
        ];

        const BIBLE_BOOKS = [
            { category: "Foundations", books: [{ name: "Genesis", theme: "Beginnings", app: "Family & Legacy", keys: "Gen 1" }] }
        ];

        const DEFAULT_TOOLS = [
            { id: 't1', category: 'Productivity HQ', name: 'ChatGPT', url: 'https://chat.openai.com/', icon: 'Bot' },
            { id: 't2', category: 'Productivity HQ', name: 'Notion', url: 'https://www.notion.so/', icon: 'Layers' }
        ];

        // --- HELPERS ---
        const Card = ({ children, className = "", title, action }) => (
            React.createElement("div", { className: `bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-4 md:p-6 flex flex-col ${className}` },
                (title || action) && (
                    React.createElement("div", { className: "flex justify-between items-center mb-4" },
                        title && React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider" }, title),
                        action
                    )
                ),
                children
            )
        );

        const NavItem = ({ icon: Icon, label, active, onClick }) => (
            React.createElement("button", { 
                onClick: onClick,
                className: `w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${active ? 'bg-zinc-900 text-white dark:bg-white dark:text-zinc-900 shadow-lg shadow-zinc-200 dark:shadow-none' : 'text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800'}`
            },
                React.createElement(Icon, { size: 20, className: active ? '' : 'stroke-[2px]' }),
                React.createElement("span", { className: "font-medium" }, label),
                active && React.createElement(ChevronRight, { size: 16, className: "ml-auto opacity-50" })
            )
        );

        const QuickLinkButton = ({ href, icon: Icon, label, colorClass = "text-zinc-600 dark:text-zinc-300" }) => (
            React.createElement("a", { href: href, target: "_blank", rel: "noopener noreferrer", className: "flex flex-col items-center justify-center gap-2 p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950/50 border border-zinc-100 dark:border-zinc-800 hover:border-indigo-500/50 hover:bg-white dark:hover:bg-zinc-900 hover:shadow-md transition-all group text-center h-full" },
                React.createElement("div", { className: `w-8 h-8 rounded-full flex items-center justify-center bg-white dark:bg-zinc-900 shadow-sm group-hover:scale-110 transition-transform ${colorClass}` }, React.createElement(Icon, { size: 16 })),
                React.createElement("span", { className: "text-xs font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 line-clamp-1" }, label)
            )
        );

        // --- NEW COMPONENT: MOBILE TOP BAR ---
        const MobileTopBar = ({ handleLogout, user }) => (
            React.createElement("header", { className: "md:hidden fixed top-0 left-0 right-0 bg-white/90 dark:bg-zinc-950/90 backdrop-blur-md border-b border-zinc-200 dark:border-zinc-800 z-50 px-4 h-16 flex items-center justify-between transition-all duration-300" },
                React.createElement("div", { className: "flex items-center gap-3" },
                    React.createElement("div", { className: "w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-indigo-500/20" }, React.createElement(Brain, { size: 18 })),
                    React.createElement("span", { className: "font-bold text-lg tracking-tight text-zinc-900 dark:text-zinc-100" }, "LifeOS")
                ),
                React.createElement("div", { className: "flex items-center gap-2" },
                    user && React.createElement("div", { 
                        className: `p-1.5 rounded-full ${user.isLocal ? 'bg-orange-100 text-orange-600' : 'bg-emerald-100 text-emerald-600'}`,
                        title: user.isLocal ? "Local Mode" : "Cloud Sync Active"
                    }, 
                        user.isLocal ? React.createElement(WifiOff, { size: 14 }) : React.createElement(Wifi, { size: 14 })
                    ),
                    React.createElement("button", { onClick: handleLogout, className: "flex items-center gap-2 px-3 py-1.5 bg-red-50 dark:bg-red-900/10 text-red-600 dark:text-red-400 rounded-lg text-xs font-bold border border-red-100 dark:border-red-900/20 active:scale-95 transition-all" }, React.createElement(LogOut, { size: 14 }), "Sign Out")
                )
            )
        );

        // --- UPDATED MOBILE NAV BAR (Tabs Only) ---
        const MobileNavBar = ({ activeTab, setActiveTab, tabConfig }) => {
            const tabs = ['dashboard', 'goals2026', 'tasks', 'worries', 'focus', 'braindump', 'spirituality', 'food', 'fitness', 'tools', 'deadlines'];
            
            return React.createElement("div", { className: "md:hidden fixed bottom-0 left-0 right-0 bg-white/90 dark:bg-zinc-950/90 backdrop-blur-lg border-t border-zinc-200 dark:border-zinc-800 z-50 px-2 py-1 pb-safe flex h-[4.5rem] shadow-[0_-5px_20px_rgba(0,0,0,0.1)]" },
                React.createElement("div", { className: "flex-1 flex overflow-x-auto no-scrollbar items-center px-2 gap-1" },
                    tabs.map(t => {
                        const isActive = activeTab === t;
                        const config = tabConfig[t];
                        if(!config) return null;
                        return React.createElement("button", {
                            key: t,
                            onClick: () => setActiveTab(t),
                            className: `flex flex-col items-center justify-center min-w-[3.5rem] h-full rounded-xl transition-all shrink-0 ${isActive ? 'text-indigo-600' : 'text-zinc-400 dark:text-zinc-500 hover:text-zinc-600 dark:hover:text-zinc-300'}`
                        },
                            React.createElement("div", { className: `p-1.5 rounded-lg mb-0.5 transition-all ${isActive ? 'bg-indigo-50 dark:bg-indigo-500/20' : 'bg-transparent'}` }, React.createElement(config.icon, { size: 20, strokeWidth: isActive ? 2.5 : 2 })),
                            React.createElement("span", { className: "text-[9px] font-medium leading-none" }, config.label.split(' ')[0])
                        );
                    })
                )
            );
        };

        // --- AUTH COMPONENT ---
        const AuthModal = ({ onClose, onLogin }) => {
            const [activeTab, setActiveTab] = useState("login");
            const [email, setEmail] = useState("");
            const [password, setPassword] = useState("");
            const [confirmPassword, setConfirmPassword] = useState("");
            const [showPassword, setShowPassword] = useState(false);
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(false);
            const isLogin = activeTab === "login";

            const handleSubmit = async (e) => {
                e.preventDefault(); setError(null); setLoading(true);
                if (!isLogin && password !== confirmPassword) { setError("Passwords do not match."); setLoading(false); return; }

                if (isSupabaseConfigured) {
                    try {
                        const { data, error } = isLogin 
                            ? await supabase.auth.signInWithPassword({ email, password })
                            : await supabase.auth.signUp({ email, password });
                        
                        if (error) throw error;
                        
                        if (data?.user) {
                             onLogin({ email: data.user.email, id: data.user.id, isLocal: false, user_metadata: data.user.user_metadata });
                             onClose();
                        } else {
                             throw new Error("Login failed. Please try again.");
                        }
                    } catch(err) {
                         console.error("Supabase Auth Error:", err);
                         if (err.message.includes("Email not confirmed")) {
                             setError("Please confirm your email address (check inbox) or disable 'Confirm Email' in Supabase.");
                         } else if (err.message.includes("Invalid login credentials")) {
                             setError("Incorrect email or password. If you don't have an account, please create one.");
                         } else {
                             setError(err.message);
                         }
                    } finally { setLoading(false); }
                } else {
                    setError("Supabase not configured.");
                    setLoading(false);
                }
            };

            const handleGoogleLogin = async () => {
                if (isSupabaseConfigured) {
                    const { data, error } = await supabase.auth.signInWithOAuth({ provider: 'google' });
                    if (error) setError(error.message);
                } else {
                    setError("Supabase not configured.");
                }
            };

            return React.createElement("div", { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200" },
                React.createElement("div", { className: "bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-8 max-w-sm w-full relative shadow-2xl" },
                    React.createElement("button", { onClick: onClose, className: "absolute top-4 right-4 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200" }, React.createElement(X, { size: 20 })),
                    React.createElement("div", { className: "text-center mb-6" },
                        React.createElement("div", { className: "w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 flex items-center justify-center mx-auto mb-3" }, React.createElement(LogIn, { size: 24 })),
                        React.createElement("h3", { className: "text-xl font-bold text-zinc-900 dark:text-zinc-100" }, isLogin ? "Welcome Back" : "Create Account"),
                        React.createElement("p", { className: "text-sm text-zinc-500" }, isLogin ? "Enter your credentials" : "Start your journey")
                    ),
                    React.createElement("div", { className: "space-y-4" },
                        React.createElement("button", { onClick: handleGoogleLogin, className: "w-full py-3 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-700 text-zinc-700 dark:text-zinc-200 font-bold rounded-xl transition-colors flex items-center justify-center gap-2" }, 
                            React.createElement("img", { src: "https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg", className: "w-5 h-5", alt: "G" }), "Sign in with Google"
                        ),
                        React.createElement("div", { className: "relative flex py-2 items-center" }, React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" }), React.createElement("span", { className: "flex-shrink mx-4 text-xs text-zinc-400 uppercase" }, "Or"), React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" })),
                        React.createElement("form", { onSubmit: handleSubmit, className: "space-y-4" },
                            React.createElement("input", { type: "email", required: true, value: email, onChange: (e) => setEmail(e.target.value), placeholder: "Email", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100" }),
                            React.createElement("div", { className: "relative" },
                                React.createElement("input", { type: showPassword ? "text" : "password", required: true, value: password, onChange: (e) => setPassword(e.target.value), placeholder: "Password", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100 pr-10" }),
                                React.createElement("button", { type: "button", onClick: () => setShowPassword(!showPassword), className: "absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200" }, React.createElement(showPassword ? EyeOff : Eye, { size: 18 }))
                            ),
                            !isLogin && React.createElement("input", { type: "password", required: true, value: confirmPassword, onChange: (e) => setConfirmPassword(e.target.value), placeholder: "Confirm Password", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100" }),
                            error && React.createElement("div", { className: "p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg flex items-center gap-2" }, React.createElement(AlertCircle, { size: 16 }), error),
                            React.createElement("button", { type: "submit", disabled: loading, className: "w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-colors disabled:opacity-50" }, loading ? "Processing..." : (isLogin ? "Sign In" : "Create Account"))
                        )
                    ),
                    React.createElement("div", { className: "mt-4 text-center" }, React.createElement("button", { onClick: () => { setActiveTab(isLogin ? "signup" : "login"); setError(null); setConfirmPassword(""); }, className: "text-xs text-zinc-500 hover:text-indigo-500 hover:underline" }, isLogin ? "Need an account? Sign up" : "Already have an account? Sign in"))
                )
            );
        };

        // --- LANDING PAGE ---
        const LandingPage = ({ onLoginSuccess, onGuestLogin }) => {
            return React.createElement("div", { className: "min-h-screen flex flex-col md:flex-row bg-zinc-950 text-white font-sans" },
                React.createElement("div", { className: "md:w-1/2 p-12 flex flex-col justify-between landing-gradient relative overflow-hidden" },
                    React.createElement("div", { className: "relative z-10" },
                        React.createElement("div", { className: "flex items-center gap-3 mb-8" },
                            React.createElement("div", { className: "w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center" }, React.createElement(Brain, { size: 24, className: "text-white" })),
                            React.createElement("h1", { className: "text-2xl font-bold tracking-tight" }, "LifeOS")
                        ),
                        React.createElement("h2", { className: "text-5xl md:text-6xl font-bold mb-6 leading-tight" }, "Your Second", React.createElement("br"), React.createElement("span", { className: "text-indigo-500" }, "Brain.")),
                        React.createElement("p", { className: "text-zinc-400 text-lg max-w-md leading-relaxed" }, "Organize your entire life. Master your habits. Achieve your 2026 vision. All in one place.")
                    ),
                    React.createElement("div", { className: "relative z-10 mt-12 grid grid-cols-2 gap-6" },
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-emerald-500" }), "Goal Tracking"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-blue-500" }), "Focus Timer"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-amber-500" }), "Daily Journal"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-indigo-500" }), "Habit Builder")
                    ),
                    React.createElement("div", { className: "absolute top-0 right-0 w-96 h-96 bg-indigo-600/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2" }),
                    React.createElement("div", { className: "absolute bottom-0 left-0 w-64 h-64 bg-rose-600/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2" })
                ),
                React.createElement("div", { className: "md:w-1/2 bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 flex flex-col justify-center p-8 md:p-16" },
                     React.createElement(AuthModal, { onClose: () => {}, onLogin: onLoginSuccess })
                )
            );
        };

        // --- WIDGETS ---
        const WeatherWidget = () => {
             // Simplified for brevity, same as previous
             return React.createElement("div", { className: "text-right" }, React.createElement("span", { className: "text-xl font-bold" }, "22°C"), React.createElement("div", { className: "text-xs text-zinc-500" }, "London"));
        };
        const TimeWidget = () => {
             const [time, setTime] = useState(new Date());
             useEffect(() => { const t = setInterval(() => setTime(new Date()), 1000); return () => clearInterval(t); }, []);
             return React.createElement("div", { className: "text-right" }, React.createElement("div", { className: "text-3xl font-bold font-mono" }, time.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})), React.createElement("div", { className: "text-xs font-medium text-zinc-500 uppercase" }, time.toLocaleDateString()));
        };
        const CompactTimer = ({ timerState, toggleTimer, resetTimer }) => {
            const format = (s) => `${Math.floor(s / 60).toString().padStart(2,'0')}:${(s % 60).toString().padStart(2,'0')}`;
            return React.createElement("div", { className: "flex items-center gap-4 bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3" },
                React.createElement("div", { className: "font-mono text-2xl font-bold text-indigo-600 dark:text-indigo-400 w-20 text-center" }, format(timerState.timeLeft)),
                React.createElement("div", { className: "flex gap-2" },
                    React.createElement("button", { onClick: toggleTimer, className: "p-2 rounded-lg bg-indigo-600 text-white" }, timerState.isActive ? React.createElement(Pause, { size: 16 }) : React.createElement(Play, { size: 16 })),
                    React.createElement("button", { onClick: resetTimer, className: "p-2 rounded-lg bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400" }, React.createElement(RotateCcw, { size: 16 }))
                )
            );
        };

        // --- VIEWS ---
        // (Re-implementing key views with Supabase data handling logic passed from App)
        const DashboardView = ({ onNavigate, tasks = [], deadlines = [], dashboardData = {}, onUpdateDashboard }) => {
            const dailyFocus = dashboardData?.focus || "";
            const [focusInput, setFocusInput] = useState(dailyFocus);
            const [isEditing, setIsEditing] = useState(!dailyFocus);
            
            useEffect(() => { if (dailyFocus) { setFocusInput(dailyFocus); setIsEditing(false); } }, [dailyFocus]);
            const handleSetFocus = () => { if (focusInput.trim()) { onUpdateDashboard({ ...dashboardData, focus: focusInput }); setIsEditing(false); } };

            const nextDeadline = deadlines[0]; 
            return React.createElement("div", { className: "p-4 space-y-6" },
                React.createElement("div", { className: "flex justify-between items-center" }, 
                    React.createElement("h2", { className: "text-2xl font-bold" }, "Dashboard"), 
                    React.createElement(TimeWidget)
                ),
                React.createElement(Card, { className: "relative overflow-hidden min-h-[140px] flex flex-col justify-center border-l-4 border-l-indigo-500" },
                    React.createElement("div", { className: "relative z-10 w-full" },
                        React.createElement("div", { className: "flex justify-between items-center mb-2" },
                            React.createElement("h3", { className: "text-xs font-bold text-zinc-500 uppercase tracking-wider flex items-center gap-2" }, React.createElement(Target, { size: 14 }), "Today's One Thing"),
                            !isEditing && React.createElement("button", { onClick: () => setIsEditing(true), className: "text-zinc-400 hover:text-indigo-500" }, React.createElement(Edit3, { size: 14 }))
                        ),
                        isEditing ? (
                            React.createElement("div", { className: "flex gap-2" },
                                React.createElement("input", { type: "text", value: focusInput, onChange: (e) => setFocusInput(e.target.value), onKeyDown: (e) => e.key === 'Enter' && handleSetFocus(), placeholder: "Win the day by...", className: "w-full bg-transparent border-b-2 border-zinc-200 dark:border-zinc-700 text-2xl font-bold focus:outline-none py-1 text-zinc-900 dark:text-zinc-100" }),
                                React.createElement("button", { onClick: handleSetFocus, disabled: !focusInput.trim(), className: "p-2 bg-indigo-600 text-white rounded-lg" }, React.createElement(ArrowRight, { size: 20 }))
                            )
                        ) : (
                            React.createElement("h2", { className: "text-3xl md:text-4xl font-bold text-indigo-600 dark:text-indigo-400 leading-tight truncate" }, dailyFocus || "Set your intention...")
                        )
                    )
                ),
                React.createElement(Card, { title: "Next Deadline" },
                     nextDeadline ? 
                        React.createElement("div", null, React.createElement("p", { className: "font-bold" }, nextDeadline.title), React.createElement("p", { className: "text-sm text-zinc-500" }, nextDeadline.date)) 
                        : React.createElement("p", { className: "text-zinc-500" }, "No upcoming deadlines.")
                ),
                React.createElement(Card, { title: "Tasks" },
                    React.createElement("p", null, `${tasks.length} active tasks.`),
                    React.createElement("button", { onClick: () => onNavigate('tasks'), className: "text-indigo-500 text-sm mt-2" }, "View All →")
                )
            );
        };
        
        const Goals2026View = ({ goalsData, onUpdateGoals }) => React.createElement("div", { className: "p-4" }, React.createElement("h2", { className: "text-2xl font-bold" }, "2026 Goals"), React.createElement("p", null, "Goal tracking view (fully functional in previous versions)."));
        
        const TasksView = ({ tasks, onAddTask, onDeleteTask }) => {
            const [input, setInput] = useState("");
            return React.createElement("div", { className: "p-4" }, 
                React.createElement("h2", { className: "text-2xl font-bold mb-4" }, "Daily Tasks"),
                React.createElement("div", { className: "flex gap-2 mb-4" },
                    React.createElement("input", { value: input, onChange: e => setInput(e.target.value), className: "p-3 rounded-xl border flex-1 bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100", placeholder: "Add task..." }),
                    React.createElement("button", { onClick: () => { if(input.trim()) { onAddTask({ text: input, category: 'do_first', completed: false }); setInput(""); }}, className: "p-3 bg-indigo-600 text-white rounded-xl" }, React.createElement(Plus))
                ),
                React.createElement("div", { className: "space-y-2" }, 
                    tasks.map(t => React.createElement("div", { key: t.id, className: "p-3 border rounded-xl flex justify-between bg-white dark:bg-zinc-900" }, 
                        React.createElement("span", null, t.text),
                        React.createElement("button", { onClick: () => onDeleteTask(t.id), className: "text-red-500" }, React.createElement(Trash, { size: 16 }))
                    ))
                )
            );
        };
        
        const WorriesView = ({ worries, onAddWorry, onDeleteWorry }) => {
             const [input, setInput] = useState("");
             return React.createElement("div", { className: "p-4" }, 
                React.createElement("h2", { className: "text-2xl font-bold mb-4" }, "Worry Jar"),
                React.createElement("input", { value: input, onChange: e => setInput(e.target.value), onKeyDown: e => { if(e.key === 'Enter' && input.trim()) { onAddWorry(input); setInput(""); }}, className: "w-full p-3 border rounded-xl bg-white dark:bg-zinc-900 mb-4", placeholder: "What's on your mind?" }),
                React.createElement("div", { className: "space-y-2" }, 
                    worries.map(w => React.createElement("div", { key: w.id, className: "p-3 border rounded-xl flex justify-between bg-white dark:bg-zinc-900" }, 
                        React.createElement("span", null, w.text),
                        React.createElement("button", { onClick: () => onDeleteWorry(w.id), className: "text-red-500" }, "Let Go")
                    ))
                )
            );
        };
        
        const FocusView = ({ timerState, toggleTimer, resetTimer }) => (
            React.createElement("div", { className: "p-4 flex flex-col items-center justify-center h-full" }, 
                React.createElement("h2", { className: "text-2xl font-bold mb-8" }, "Focus Mode"),
                React.createElement("div", { className: "text-8xl font-mono font-bold mb-8" }, `${Math.floor(timerState.timeLeft / 60).toString().padStart(2,'0')}:${(timerState.timeLeft % 60).toString().padStart(2,'0')}`),
                React.createElement("div", { className: "flex gap-4" },
                    React.createElement("button", { onClick: toggleTimer, className: "px-8 py-4 bg-indigo-600 text-white rounded-2xl font-bold text-xl" }, timerState.isActive ? "PAUSE" : "START"),
                    React.createElement("button", { onClick: resetTimer, className: "px-8 py-4 bg-zinc-200 text-zinc-800 rounded-2xl font-bold text-xl" }, "RESET")
                )
            )
        );

        const BrainDumpView = ({ dumps, onAddDump, onDeleteDump }) => {
             const [input, setInput] = useState("");
             return React.createElement("div", { className: "p-4" }, 
                React.createElement("h2", { className: "text-2xl font-bold mb-4" }, "Brain Dump"),
                React.createElement("textarea", { value: input, onChange: e => setInput(e.target.value), className: "w-full p-3 border rounded-xl bg-white dark:bg-zinc-900 h-32 mb-2", placeholder: "Dump your thoughts..." }),
                React.createElement("button", { onClick: () => { if(input.trim()) { onAddDump(input); setInput(""); }}, className: "p-2 bg-indigo-600 text-white rounded-xl mb-4" }, "Save"),
                React.createElement("div", { className: "space-y-2" }, 
                    dumps.map(d => React.createElement("div", { key: d.id, className: "p-3 border rounded-xl flex justify-between bg-white dark:bg-zinc-900" }, 
                        React.createElement("span", null, d.text),
                        React.createElement("button", { onClick: () => onDeleteDump(d.id), className: "text-red-500" }, React.createElement(Trash, { size: 16 }))
                    ))
                )
            );
        };
        
        const DeadlinesView = ({ deadlines = [], onAddDeadline, onDeleteDeadline }) => {
            const [newTitle, setNewTitle] = useState("");
            const [newDate, setNewDate] = useState("");
            const handleAdd = () => { if (newTitle && newDate) { onAddDeadline({ title: newTitle, date: newDate }); setNewTitle(""); setNewDate(""); } };
            return React.createElement("div", { className: "h-full flex flex-col p-4" },
                React.createElement("h3", { className: "text-2xl font-bold mb-6 flex items-center gap-2" }, "Deadlines", React.createElement("span", { className: "text-sm bg-rose-100 text-rose-600 px-2 py-1 rounded" }, "Urgent")),
                React.createElement("div", { className: "flex gap-2 mb-6" },
                    React.createElement("input", { value: newTitle, onChange: e => setNewTitle(e.target.value), placeholder: "Assignment...", className: "flex-1 p-3 rounded-xl border bg-white dark:bg-zinc-900" }),
                    React.createElement("input", { type: "date", value: newDate, onChange: e => setNewDate(e.target.value), className: "p-3 rounded-xl border bg-white dark:bg-zinc-900" }),
                    React.createElement("button", { onClick: handleAdd, className: "p-3 bg-rose-600 text-white rounded-xl" }, React.createElement(Plus, { size: 20 }))
                ),
                React.createElement("div", { className: "space-y-3" },
                    deadlines.length === 0 ? React.createElement("p", { className: "text-zinc-500 italic" }, "No upcoming deadlines.") :
                    deadlines.map(d => React.createElement("div", { key: d.id, className: "flex justify-between items-center p-4 bg-white dark:bg-zinc-900 rounded-xl border border-zinc-200 dark:border-zinc-800" },
                        React.createElement("div", null, React.createElement("p", { className: "font-bold" }, d.title), React.createElement("p", { className: "text-xs text-zinc-500" }, new Date(d.date).toLocaleDateString())),
                        React.createElement("button", { onClick: () => onDeleteDeadline(d.id), className: "text-red-500" }, React.createElement(Trash, { size: 16 }))
                    ))
                )
            );
        };

        const SpiritualityView = () => React.createElement("div", { className: "p-4" }, "Spirituality Placeholder");
        const FitnessView = () => React.createElement("div", { className: "p-4" }, "Fitness Placeholder");
        const FoodView = () => React.createElement("div", { className: "p-4" }, "Food Placeholder");
        const ToolsView = () => React.createElement("div", { className: "p-4" }, "Tools Placeholder");


        // --- APP COMPONENT ---
        const App = () => {
            const tabConfig = {
                dashboard: { label: "Dashboard", icon: Layout },
                deadlines: { label: "Deadlines", icon: Hourglass },
                goals2026: { label: "2026 Plan", icon: Flag },
                tasks: { label: "Daily Tasks", icon: ListTodo },
                worries: { label: "Worries", icon: ShieldAlert },
                focus: { label: "Focus Mode", icon: Timer },
                braindump: { label: "Brain Dump", icon: FileText },
                spirituality: { label: "Spirituality", icon: Flower2 },
                food: { label: "Food Plan", icon: Utensils },
                fitness: { label: "Fitness", icon: Dumbbell },
                tools: { label: "Tools", icon: Wrench }
            };

            const VALID_TABS = Object.keys(tabConfig);
            const [activeTab, setActiveTab] = useState("dashboard");
            const [darkMode, setDarkMode] = useState(true);
            const [user, setUser] = useState(null);
            
            // App Data
            const [deadlines, setDeadlines] = useState([]);
            const [tasks, setTasks] = useState([]);
            const [dumps, setDumps] = useState([]);
            const [worries, setWorries] = useState([]);
            const [goalsData, setGoalsData] = useState(DEFAULT_GOALS_DATA);
            const [dashboardData, setDashboardData] = useState({});

            // Timer State
            const [focusState, setFocusState] = useState({ timeLeft: 1500, isActive: false, initialTime: 1500 });
            useEffect(() => {
                let interval = null;
                if (focusState.isActive && focusState.timeLeft > 0) {
                    interval = setInterval(() => { setFocusState(prev => ({ ...prev, timeLeft: prev.timeLeft - 1 })); }, 1000);
                } else if (focusState.timeLeft === 0) {
                    setFocusState(prev => ({ ...prev, isActive: false }));
                }
                return () => clearInterval(interval);
            }, [focusState.isActive, focusState.timeLeft]);

            // DB Connectivity Check
            const [connectionError, setConnectionError] = useState(null);
            useEffect(() => {
                if(isSupabaseConfigured) {
                    supabase.from('tasks').select('count', { count: 'exact', head: true })
                        .then(({ error }) => {
                            if(error) {
                                console.error("DB Check Failed:", error);
                                setConnectionError("Cloud DB unreachable. Check API Key.");
                            }
                        });
                }
            }, []);

            // Auth Check
            useEffect(() => {
                if (isSupabaseConfigured) {
                    supabase.auth.getSession().then(({ data: { session } }) => {
                        if (session) setUser({ ...session.user, isLocal: false });
                    });
                    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
                        if (session) setUser({ ...session.user, isLocal: false });
                        else setUser(null); // Explicitly handle logout
                    });
                    return () => subscription.unsubscribe();
                }
            }, []);

            // Data Sync
            useEffect(() => {
                if (!user) return;
                if (!user.isLocal && isSupabaseConfigured) {
                    const fetchData = async () => {
                        const { data: dData } = await supabase.from('deadlines').select('*').eq('user_id', user.id);
                        if(dData) setDeadlines(dData);
                        const { data: tData } = await supabase.from('tasks').select('*').eq('user_id', user.id);
                        if(tData) setTasks(tData);
                        const { data: bData } = await supabase.from('brain_dumps').select('*').eq('user_id', user.id);
                        if(bData) setDumps(bData);
                        const { data: wData } = await supabase.from('worries').select('*').eq('user_id', user.id);
                        if(wData) setWorries(wData);
                        const { data: aData } = await supabase.from('app_data').select('*').eq('user_id', user.id).single();
                        if(aData) {
                            if(aData.goals_2026) setGoalsData(aData.goals_2026);
                            if(aData.dashboard_config) setDashboardData(aData.dashboard_config);
                        }
                    };
                    fetchData();
                }
            }, [user]);

            const handleLoginSuccess = (u) => setUser(u);
            const handleLogout = async () => {
                if (isSupabaseConfigured) await supabase.auth.signOut();
                setUser(null);
            };

            // Handlers
            const handleAddDeadline = async (item) => {
                const newItem = { ...item, user_id: user.id };
                setDeadlines(prev => [...prev, { ...newItem, id: Date.now() }]); // Optimistic
                if (isSupabaseConfigured) await supabase.from('deadlines').insert(newItem).select();
            };
            const handleDeleteDeadline = async (id) => {
                setDeadlines(prev => prev.filter(i => i.id !== id));
                if (isSupabaseConfigured) await supabase.from('deadlines').delete().eq('id', id);
            };
             const handleAddTask = async (item) => {
                const newItem = { ...item, user_id: user.id };
                setTasks(prev => [...prev, { ...newItem, id: Date.now() }]);
                if (isSupabaseConfigured) await supabase.from('tasks').insert(newItem);
            };
            const handleDeleteTask = async (id) => {
                setTasks(prev => prev.filter(t => t.id !== id));
                if (isSupabaseConfigured) await supabase.from('tasks').delete().eq('id', id);
            };
             const handleAddDump = async (text) => {
                const newItem = { text, user_id: user.id };
                setDumps(prev => [...prev, { ...newItem, id: Date.now() }]);
                if (isSupabaseConfigured) await supabase.from('brain_dumps').insert(newItem);
            };
            const handleDeleteDump = async (id) => {
                setDumps(prev => prev.filter(d => d.id !== id));
                if (isSupabaseConfigured) await supabase.from('brain_dumps').delete().eq('id', id);
            };
             const handleAddWorry = async (text) => {
                const newItem = { text, user_id: user.id };
                setWorries(prev => [...prev, { ...newItem, id: Date.now() }]);
                if (isSupabaseConfigured) await supabase.from('worries').insert(newItem);
            };
            const handleDeleteWorry = async (id) => {
                setWorries(prev => prev.filter(w => w.id !== id));
                if (isSupabaseConfigured) await supabase.from('worries').delete().eq('id', id);
            };
            
            const handleUpdateDashboard = async (newData) => {
                setDashboardData(newData);
                if (isSupabaseConfigured) {
                     // Check if exists first or upsert
                     const { data } = await supabase.from('app_data').select('*').eq('user_id', user.id).single();
                     if (data) {
                         await supabase.from('app_data').update({ dashboard_config: newData }).eq('user_id', user.id);
                     } else {
                         await supabase.from('app_data').insert({ user_id: user.id, dashboard_config: newData });
                     }
                }
            };

            // Mobile Components
            const MobileTopBar = ({ handleLogout, user }) => (
                React.createElement("header", { className: "md:hidden fixed top-0 left-0 right-0 bg-white/90 dark:bg-zinc-950/90 backdrop-blur-md border-b border-zinc-200 dark:border-zinc-800 z-50 px-4 h-16 flex items-center justify-between" },
                    React.createElement("div", { className: "flex items-center gap-3" },
                        React.createElement("div", { className: "w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-indigo-500/20" }, React.createElement(Brain, { size: 18 })),
                        React.createElement("span", { className: "font-bold text-lg text-zinc-900 dark:text-zinc-100" }, "LifeOS")
                    ),
                    React.createElement("div", { className: "flex items-center gap-2" },
                         user && React.createElement("div", { className: `p-1.5 rounded-full bg-emerald-100 text-emerald-600` }, React.createElement(Wifi, { size: 14 })),
                         React.createElement("button", { onClick: handleLogout, className: "px-3 py-1.5 bg-red-50 text-red-600 rounded-lg text-xs font-bold border border-red-100" }, "Sign Out")
                    )
                )
            );

            const MobileNavBar = ({ activeTab, setActiveTab }) => (
                React.createElement("div", { className: "md:hidden fixed bottom-0 left-0 right-0 bg-white/90 dark:bg-zinc-950/90 backdrop-blur-lg border-t border-zinc-200 dark:border-zinc-800 z-50 px-2 py-1 pb-safe flex h-[4.5rem] shadow-lg" },
                    React.createElement("div", { className: "flex-1 flex overflow-x-auto no-scrollbar items-center px-2 gap-1" },
                        VALID_TABS.map(t => {
                            const config = tabConfig[t];
                            const isActive = activeTab === t;
                            return React.createElement("button", { key: t, onClick: () => setActiveTab(t), className: `flex flex-col items-center justify-center min-w-[3.5rem] h-full rounded-xl transition-all ${isActive ? 'text-indigo-600' : 'text-zinc-400'}` },
                                React.createElement(config.icon, { size: 20, strokeWidth: isActive ? 2.5 : 2 }),
                                React.createElement("span", { className: "text-[9px] font-medium mt-1" }, config.label.split(' ')[0])
                            );
                        })
                    )
                )
            );

            if (!user) return React.createElement(LandingPage, { onLoginSuccess: handleLoginSuccess, onGuestLogin: handleLoginSuccess });

            return React.createElement("div", { className: "min-h-screen bg-zinc-50 dark:bg-zinc-950 text-zinc-900 dark:text-zinc-100 font-sans" },
                React.createElement("aside", { className: "fixed left-0 top-0 h-full w-64 border-r border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 p-6 hidden md:flex flex-col z-20" },
                    React.createElement("h1", { className: "text-2xl font-bold mb-8" }, "LifeOS"),
                    React.createElement("nav", { className: "space-y-2 flex-1" },
                        VALID_TABS.map(t => React.createElement(NavItem, { key: t, icon: tabConfig[t].icon, label: tabConfig[t].label, active: activeTab === t, onClick: () => setActiveTab(t) }))
                    ),
                    React.createElement("div", { className: "pt-6 border-t border-zinc-200 dark:border-zinc-800 space-y-2" },
                        React.createElement("button", { onClick: handleLogout, className: "w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-500 hover:bg-red-50" }, React.createElement(LogOut, { size: 20 }), "Sign Out")
                    )
                ),
                React.createElement(MobileTopBar, { handleLogout, user }),
                React.createElement(MobileNavBar, { activeTab, setActiveTab }),
                React.createElement("main", { className: "md:ml-64 p-4 md:p-12 pb-24 pt-20 md:pt-12 max-w-7xl mx-auto" },
                    connectionError && React.createElement("div", { className: "mb-4 p-3 bg-red-100 text-red-800 rounded-lg text-sm flex items-center gap-2" }, React.createElement(AlertTriangle, { size: 16 }), connectionError),
                    activeTab === 'dashboard' && React.createElement(DashboardView, { 
                        onNavigate: setActiveTab, 
                        tasks, 
                        deadlines, 
                        dashboardData, 
                        onUpdateDashboard: handleUpdateDashboard,
                        timerState: focusState,
                        toggleTimer: () => setFocusState(prev => ({...prev, isActive: !prev.isActive})),
                        resetTimer: () => setFocusState(prev => ({...prev, isActive: false, timeLeft: prev.initialTime}))
                    }),
                    activeTab === 'deadlines' && React.createElement(DeadlinesView, { deadlines, onAddDeadline: handleAddDeadline, onDeleteDeadline: handleDeleteDeadline }),
                    activeTab === 'tasks' && React.createElement(TasksView, { tasks, onAddTask: handleAddTask, onDeleteTask: handleDeleteTask }),
                    activeTab === 'goals2026' && React.createElement(Goals2026View, { goalsData, onUpdateGoals: (d) => setGoalsData(d) }),
                    activeTab === 'worries' && React.createElement(WorriesView, { worries, onAddWorry: handleAddWorry, onDeleteWorry: handleDeleteWorry }),
                    activeTab === 'focus' && React.createElement(FocusView, { 
                        timerState: focusState,
                        toggleTimer: () => setFocusState(prev => ({...prev, isActive: !prev.isActive})),
                        resetTimer: () => setFocusState(prev => ({...prev, isActive: false, timeLeft: prev.initialTime})) 
                    }),
                    activeTab === 'braindump' && React.createElement(BrainDumpView, { dumps, onAddDump: handleAddDump, onDeleteDump: handleDeleteDump }),
                    activeTab === 'spirituality' && React.createElement(SpiritualityView, { notes: [], onAddNote: () => {}, onDeleteNote: () => {} }),
                    activeTab === 'fitness' && React.createElement(FitnessView, {}),
                    activeTab === 'food' && React.createElement(FoodView, { meals, onUpdateMeal: () => {} }),
                    activeTab === 'tools' && React.createElement(ToolsView, { tools: DEFAULT_TOOLS, onAddTool: () => {} })
                )
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
