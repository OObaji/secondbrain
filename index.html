<!DOCTYPE html>
<html lang="en" class="overflow-x-hidden">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LifeOS - Second Brain</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        zinc: {
                            850: '#1f1f22',
                            950: '#09090b',
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            -webkit-font-smoothing: antialiased; 
            touch-action: manipulation;
        }
        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #52525b; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #71717a; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake {
            animation: shake 0.2s ease-in-out 2;
        }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-100 min-h-screen overflow-y-auto">
    <div id="root"></div>

    <!-- Application Logic -->
    <script type="module">
        import React, { useState, useEffect, useRef } from "https://esm.sh/react@18.2.0";
        import { createRoot } from "https://esm.sh/react-dom@18.2.0/client";
        import { 
            Layout, Home, BookOpen, Target, PenTool, Settings, Search, Bell, Plus, 
            MoreHorizontal, CheckCircle2, Clock, ArrowRight, Brain, Layers, 
            Calendar as CalendarIcon, ChevronRight, Sun, Moon, Filter, Zap, Coffee, 
            Video, MapPin, RefreshCw, MoreVertical, Lightbulb, Sparkles, Trash2, 
            Sprout, Briefcase, DollarSign, Move, Eraser, Palette, MousePointer2, 
            Trophy, Flag, TrendingUp, Award, Crosshair, Star, Bookmark, Book, 
            GraduationCap, Wallet, Building, Users, ExternalLink, Link as LinkIcon, 
            PlayCircle, Film, Music, Gamepad2, MonitorPlay, Headphones, Tv, 
            MessageSquare, AlertCircle, Folder, Minus, CalendarDays, LogOut, Lock, 
            Fingerprint, Delete, KeyRound, ShieldQuestion, RotateCcw, Menu, X, Save, Edit3, Wifi, WifiOff, Database,
            Timer, Play, Pause, Wrench, File, CreditCard, Coins, Heart, Activity, Scissors, Share2, Mail, Archive, Image,
            Cloud, CloudRain, CloudSun, CloudSnow, CloudLightning, Thermometer,
            List, Grid, Columns, Utensils, FileText, Trash, ShieldAlert, Flame, Volume2, ChevronLeft
        } from "https://esm.sh/lucide-react@0.344.0?deps=react@18.2.0";

        // --- FIREBASE IMPORTS ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
        import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, addDoc, updateDoc, deleteDoc, query, orderBy, serverTimestamp, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // --- CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyCKGxtGBjHjHkOh902YgfU6h4-NBk065z0",
            authDomain: "secondbrain-8d8cd.firebaseapp.com",
            projectId: "secondbrain-8d8cd",
            storageBucket: "secondbrain-8d8cd.firebasestorage.app",
            messagingSenderId: "1913632272",
            appId: "1:1913632272:web:324f366a35e6dd07cffc95",
            measurementId: "G-V2BXKYRC5X"
        };
        
        const appId = 'kaizen-os-prod';
        
        // Initialize Firebase safely
        let app, auth, db, analytics;
        let isFirebaseConfigured = false;
        
        try {
            if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                analytics = getAnalytics(app);
                isFirebaseConfigured = true;
            } else {
                console.warn("Firebase not configured. Running in UI-only mode.");
            }
        } catch (e) {
            console.error("Firebase initialization failed:", e);
            isFirebaseConfigured = false;
        }

        // --- DATA ---
        const DEFAULT_MEALS = [
            { day: 'Monday', type: 'Breakfast', text: 'Boiled eggs + bread + tea/coffee' },
            { day: 'Monday', type: 'Lunch', text: 'Jollof rice + chicken' },
            { day: 'Monday', type: 'Dinner', text: 'Indomie + boiled egg + veggies' },
            { day: 'Tuesday', type: 'Breakfast', text: 'Oats with banana + peanut butter' },
            { day: 'Tuesday', type: 'Lunch', text: 'Leftover jollof rice + chicken' },
            { day: 'Tuesday', type: 'Dinner', text: 'Grilled chicken wrap (use leftover chicken)' },
            { day: 'Wednesday', type: 'Breakfast', text: 'Avocado + boiled egg sandwich' },
            { day: 'Wednesday', type: 'Lunch', text: 'Fried rice + beef/plantain' },
            { day: 'Wednesday', type: 'Dinner', text: 'Sweet potatoes + egg sauce' },
            { day: 'Thursday', type: 'Breakfast', text: 'Greek yoghurt + granola + fruit' },
            { day: 'Thursday', type: 'Lunch', text: 'Leftover fried rice + boiled egg side' },
            { day: 'Thursday', type: 'Dinner', text: 'Indomie stir fry with mixed vegetables' },
            { day: 'Friday', type: 'Breakfast', text: 'Toast + fried eggs + baked beans' },
            { day: 'Friday', type: 'Lunch', text: 'Jollof spaghetti' },
            { day: 'Friday', type: 'Dinner', text: 'Pizza night' },
            { day: 'Saturday', type: 'Breakfast', text: 'Pancakes (bulk, freeze, reheat)' },
            { day: 'Saturday', type: 'Lunch', text: 'White rice + stew (tomato/pepper mix) + chicken/fish' },
            { day: 'Saturday', type: 'Dinner', text: 'White rice + leftover stew' },
            { day: 'Sunday', type: 'Breakfast', text: 'Plantain + scrambled eggs' },
            { day: 'Sunday', type: 'Lunch', text: 'White spaghetti & sauce' },
            { day: 'Sunday', type: 'Dinner', text: 'Beans & plantain' }
        ];

        // --- COMPONENTS ---

        const Card = ({ children, className = "", title, action }) => (
            React.createElement("div", { className: `bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-4 md:p-6 flex flex-col ${className}` },
                (title || action) && (
                    React.createElement("div", { className: "flex justify-between items-center mb-4" },
                        title && React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider" }, title),
                        action
                    )
                ),
                children
            )
        );

        const NavItem = ({ icon: Icon, label, active, onClick }) => (
            React.createElement("button", { 
                onClick: onClick,
                className: `w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${active ? 'bg-zinc-900 text-white dark:bg-white dark:text-zinc-900 shadow-lg shadow-zinc-200 dark:shadow-none' : 'text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800'}`
            },
                React.createElement(Icon, { size: 20, className: active ? '' : 'stroke-[2px]' }),
                React.createElement("span", { className: "font-medium" }, label),
                active && React.createElement(ChevronRight, { size: 16, className: "ml-auto opacity-50" })
            )
        );

        const QuickLinkButton = ({ href, icon: Icon, label, colorClass = "text-zinc-600 dark:text-zinc-300" }) => (
            React.createElement("a", { 
                href: href, 
                target: "_blank", 
                rel: "noopener noreferrer",
                className: "flex flex-col items-center justify-center gap-2 p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950/50 border border-zinc-100 dark:border-zinc-800 hover:border-indigo-500/50 hover:bg-white dark:hover:bg-zinc-900 hover:shadow-md transition-all group text-center h-full"
            },
                React.createElement("div", { className: `w-8 h-8 rounded-full flex items-center justify-center bg-white dark:bg-zinc-900 shadow-sm group-hover:scale-110 transition-transform ${colorClass}` },
                    React.createElement(Icon, { size: 16 })
                ),
                React.createElement("span", { className: "text-xs font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 line-clamp-1" }, label)
            )
        );

        // --- WIDGETS ---

        const WeatherWidget = () => {
            const [weather, setWeather] = useState(null);
            const [locationName, setLocationName] = useState("Detecting...");
            const [loading, setLoading] = useState(true);

            const getWeatherDescription = (code) => {
                const codes = {
                    0: "Clear Sky", 1: "Mainly Clear", 2: "Partly Cloudy", 3: "Overcast",
                    45: "Fog", 48: "Depositing Rime Fog",
                    51: "Light Drizzle", 53: "Moderate Drizzle", 55: "Dense Drizzle",
                    56: "Freezing Drizzle", 57: "Dense Freezing Drizzle",
                    61: "Slight Rain", 63: "Moderate Rain", 65: "Heavy Rain",
                    66: "Freezing Rain", 67: "Heavy Freezing Rain",
                    71: "Slight Snow", 73: "Moderate Snow", 75: "Heavy Snow",
                    77: "Snow Grains",
                    80: "Slight Rain Showers", 81: "Moderate Rain Showers", 82: "Violent Rain Showers",
                    85: "Slight Snow Showers", 86: "Heavy Snow Showers",
                    95: "Thunderstorm", 96: "Thunderstorm + Hail", 99: "Heavy Thunderstorm + Hail"
                };
                return codes[code] || "Unknown";
            };

            const fetchWeather = async (latitude, longitude) => {
                try {
                    // Fetch Weather Data
                    const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weather_code&daily=temperature_2m_max,temperature_2m_min&timezone=auto`);
                    if (!response.ok) throw new Error("Weather API Error");
                    const data = await response.json();
                    setWeather(data);

                    // Fetch Location Name (Reverse Geocoding)
                    try {
                        const geoResponse = await fetch(`https://geocoding-api.open-meteo.com/v1/reverse?latitude=${latitude}&longitude=${longitude}&count=1&language=en&format=json`);
                        if (geoResponse.ok) {
                            const geoData = await geoResponse.json();
                            if (geoData.results && geoData.results[0]) {
                                const place = geoData.results[0];
                                const city = place.name;
                                const region = place.admin1; // e.g. Wales, England, California
                                
                                // Smart formatting: "Cardiff, Wales" or just "London" if region is redundant/same
                                if (region && region !== city && (city.length + region.length < 25)) {
                                    setLocationName(`${city}, ${region}`);
                                } else {
                                    setLocationName(city);
                                }
                            } else {
                                setLocationName("Local Location");
                            }
                        }
                    } catch (geoError) {
                        console.warn("Geocoding failed, defaulting name");
                        setLocationName("Local Area");
                    }

                } catch (error) {
                    console.warn("Weather fetch failed, using fallback", error);
                    // Fallback Data (Manchester defaults)
                    setWeather({
                        current: { temperature_2m: 12, weather_code: 3 }
                    });
                    setLocationName("Manchester (Offline)");
                } finally {
                    setLoading(false);
                }
            };

            useEffect(() => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            fetchWeather(position.coords.latitude, position.coords.longitude);
                        }, 
                        (error) => {
                            console.warn("Geolocation denied/failed, defaulting to Manchester", error);
                            fetchWeather(53.4808, -2.2426); // Default to Manchester
                        }
                    );
                } else {
                    fetchWeather(53.4808, -2.2426);
                }
            }, []);

            if (loading) return React.createElement("div", { className: "animate-pulse h-12 w-32 bg-zinc-100 dark:bg-zinc-800 rounded-lg" });

            const temp = weather?.current?.temperature_2m;
            const code = weather?.current?.weather_code;
            const description = getWeatherDescription(code || 0);
            
            let Icon = Cloud;
            if (code === 0 || code === 1) Icon = Sun;
            else if (code > 1 && code < 48) Icon = CloudSun;
            else if (code >= 51 && code <= 67) Icon = CloudRain;
            else if (code >= 71) Icon = CloudSnow;
            else if (code >= 95) Icon = CloudLightning;

            return React.createElement("div", { className: "flex flex-col items-end text-zinc-700 dark:text-zinc-200" },
                React.createElement("div", { className: "flex items-center gap-2" },
                    React.createElement(Icon, { size: 20 }),
                    React.createElement("span", { className: "text-xl font-bold" }, temp !== undefined ? `${Math.round(temp)}°C` : "--")
                ),
                React.createElement("div", { className: "flex items-center gap-1 text-xs text-zinc-500 uppercase tracking-wide font-medium mt-0.5" },
                    React.createElement("span", null, locationName),
                    React.createElement("span", null, "•"),
                    React.createElement("span", null, description)
                )
            );
        };

        const TimeWidget = () => {
            const [time, setTime] = useState(new Date());
            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            return React.createElement("div", { className: "text-right" },
                React.createElement("div", { className: "text-3xl font-bold font-mono tracking-tight text-zinc-900 dark:text-zinc-100" }, 
                    time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                ),
                React.createElement("div", { className: "text-xs font-medium text-zinc-500 uppercase tracking-wider" }, 
                    time.toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric' })
                )
            );
        };

        const CompactTimer = () => {
            const [timeLeft, setTimeLeft] = useState(25 * 60);
            const [isActive, setIsActive] = useState(false);

            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => setTimeLeft(t => t - 1), 1000);
                } else if (timeLeft === 0) setIsActive(false);
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            return React.createElement("div", { className: "flex items-center gap-4 bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3" },
                React.createElement("div", { className: "font-mono text-2xl font-bold text-indigo-600 dark:text-indigo-400 w-20 text-center" }, formatTime(timeLeft)),
                React.createElement("div", { className: "flex gap-2" },
                    React.createElement("button", { onClick: () => setIsActive(!isActive), className: "p-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition-colors" }, 
                        isActive ? React.createElement(Pause, { size: 16 }) : React.createElement(Play, { size: 16 })
                    ),
                    React.createElement("button", { onClick: () => { setIsActive(false); setTimeLeft(25*60); }, className: "p-2 rounded-lg bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-300 dark:hover:bg-zinc-700 transition-colors" }, 
                        React.createElement(RotateCcw, { size: 16 })
                    )
                )
            );
        };

        // --- VIEWS ---

        const DashboardView = ({ onNavigate, meals = [] }) => {
            const [dailyFocus, setDailyFocus] = useState("");
            const [isEditing, setIsEditing] = useState(true);
            const [focusInput, setFocusInput] = useState("");
            const [quote, setQuote] = useState({ text: "Focus is about saying no.", author: "Steve Jobs" });
            const [habits, setHabits] = useState([
                { id: 1, category: "Spiritual", label: "Pray & read my bible", completed: false, icon: Book, color: "text-amber-600 bg-amber-50 dark:bg-amber-900/20" },
                { id: 2, category: "Mindset", label: "Read for 10 minutes", completed: false, icon: BookOpen, color: "text-blue-500 bg-blue-50 dark:bg-blue-900/20" },
                { id: 3, category: "Health & fitness", label: "Exercise daily", completed: false, icon: Activity, color: "text-emerald-500 bg-emerald-50 dark:bg-emerald-900/20" },
                { id: 4, category: "Personal development", label: "Journal daily", completed: false, icon: PenTool, color: "text-purple-500 bg-purple-50 dark:bg-purple-900/20" }
            ]);

            // Food Logic
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const todayName = days[new Date().getDay()];
            
            const getMeal = (type) => {
                const userMeal = meals.find(m => m.day === todayName && m.type === type);
                if (userMeal) return userMeal.text;
                const defaultMeal = DEFAULT_MEALS.find(m => m.day === todayName && m.type === type);
                return defaultMeal ? defaultMeal.text : "Not planned";
            };

            useEffect(() => {
                const quotes = [
                    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
                    { text: "It is not enough to be busy... The question is: what are we busy about?", author: "Henry David Thoreau" },
                    { text: "Amateurs sit and wait for inspiration, the rest of us just get up and go to work.", author: "Stephen King" },
                    { text: "Simplicity is the ultimate sophistication.", author: "Leonardo da Vinci" },
                    { text: "Focus on being productive instead of busy.", author: "Tim Ferriss" },
                    { text: "Until we can manage time, we can manage nothing else.", author: "Peter Drucker" }
                ];
                setQuote(quotes[Math.floor(Math.random() * quotes.length)]);
            }, []);

            const toggleHabit = (id) => setHabits(habits.map(h => h.id === id ? { ...h, completed: !h.completed } : h));

            const handleSetFocus = () => {
                if (focusInput.trim()) {
                    setDailyFocus(focusInput);
                    setIsEditing(false);
                }
            };

            const handleEditFocus = () => {
                setFocusInput(dailyFocus);
                setIsEditing(true);
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') handleSetFocus();
            };

             return React.createElement("div", { className: "animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "mb-8 flex items-end justify-between" },
                    React.createElement("div", null,
                        React.createElement("h2", { className: "text-xl font-bold text-zinc-400 mb-2 uppercase tracking-widest" }, "My Dashboard"),
                        React.createElement(WeatherWidget)
                    ),
                    React.createElement(TimeWidget)
                ),
                React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8" },
                    React.createElement(Card, { className: "lg:col-span-2 relative overflow-hidden group min-h-[200px] flex flex-col justify-center" },
                        React.createElement("div", { className: "absolute top-0 right-0 w-64 h-64 bg-indigo-500/5 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none" }),
                        React.createElement("div", { className: "relative z-10 w-full" },
                            React.createElement("div", { className: "flex justify-between items-center mb-4" },
                                React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider flex items-center gap-2" }, 
                                    React.createElement(Target, { size: 16 }), "Today's Intention"
                                ),
                                !isEditing && React.createElement("button", { 
                                    onClick: handleEditFocus,
                                    className: "text-zinc-400 hover:text-indigo-500 transition-colors p-2 rounded-lg hover:bg-zinc-100 dark:hover:bg-zinc-800"
                                }, React.createElement(Edit3, { size: 16 }))
                            ),
                            
                            isEditing ? (
                                React.createElement("div", { className: "flex gap-2" },
                                    React.createElement("input", {
                                        type: "text",
                                        value: focusInput,
                                        onChange: (e) => setFocusInput(e.target.value),
                                        onKeyDown: handleKeyDown,
                                        placeholder: "What is your ONE win for today?",
                                        className: "w-full bg-transparent border-b-2 border-zinc-200 dark:border-zinc-700 focus:border-indigo-500 text-3xl font-bold text-zinc-900 dark:text-zinc-100 placeholder:text-zinc-300 dark:placeholder:text-zinc-700 focus:outline-none transition-colors py-2"
                                    }),
                                    React.createElement("button", { 
                                        onClick: handleSetFocus,
                                        disabled: !focusInput.trim(),
                                        className: "p-3 bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-indigo-700 text-white rounded-xl transition-colors"
                                    }, React.createElement(ArrowRight, { size: 24 }))
                                )
                            ) : (
                                React.createElement("div", { className: "animate-in fade-in zoom-in-95 duration-300" },
                                    React.createElement("p", { className: "text-xs font-medium text-zinc-400 mb-2" }, "TODAY IS A WIN IF I..."),
                                    React.createElement("h2", { className: "text-4xl md:text-5xl font-bold text-indigo-600 dark:text-indigo-400 leading-tight tracking-tight break-words" }, dailyFocus)
                                )
                            )
                        )
                    ),
                    React.createElement(Card, { title: "Daily Inspiration", className: "flex flex-col justify-center bg-gradient-to-br from-white to-zinc-50 dark:from-zinc-900 dark:to-zinc-950" },
                         React.createElement("div", { className: "relative z-10" },
                             React.createElement("div", { className: "absolute -left-2 -top-2 text-6xl text-zinc-100 dark:text-zinc-800 font-serif opacity-50 select-none" }, "“"),
                             React.createElement("blockquote", { className: "text-lg font-medium text-zinc-700 dark:text-zinc-300 mb-4 leading-relaxed relative z-10 pl-2" }, `"${quote.text}"`),
                             React.createElement("cite", { className: "text-xs font-bold text-zinc-400 uppercase tracking-wider block text-right not-italic" }, `— ${quote.author}`)
                         )
                    )
                ),
                React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8" },
                    // Left Column: Focus Timer + Food
                    React.createElement("div", { className: "flex flex-col gap-6" },
                        React.createElement(Card, { title: "Focus Timer", className: "flex flex-col justify-center", action: React.createElement("button", { onClick: () => onNavigate('focus'), className: "text-xs font-medium text-indigo-500 hover:text-indigo-400 flex items-center gap-1" }, "Full Mode", React.createElement(ArrowRight, { size: 12 })) },
                             React.createElement(CompactTimer)
                        ),
                        React.createElement(Card, { title: "Today's Fuel", className: "flex-1", action: React.createElement("button", { onClick: () => onNavigate('food'), className: "text-xs font-medium text-emerald-500 hover:text-emerald-400 flex items-center gap-1" }, "View Plan", React.createElement(ArrowRight, { size: 12 })) },
                            React.createElement("div", { className: "space-y-4" },
                                ['Breakfast', 'Lunch', 'Dinner'].map(type => (
                                    React.createElement("div", { key: type, className: "flex flex-col" },
                                        React.createElement("span", { className: "text-[10px] uppercase tracking-wider font-bold text-zinc-400 mb-1" }, type),
                                        React.createElement("span", { className: "text-sm font-medium text-zinc-700 dark:text-zinc-200 line-clamp-2 leading-snug" }, getMeal(type))
                                    )
                                ))
                            )
                        )
                    ),
                    // Right Column: Daily Focus (Spans 2)
                    React.createElement(Card, { title: "Daily Focus", className: "lg:col-span-2 h-full" },
                        React.createElement("div", { className: "grid grid-cols-1 sm:grid-cols-2 gap-3 h-full" },
                            habits.map(habit => (
                                React.createElement("button", { 
                                    key: habit.id,
                                    onClick: () => toggleHabit(habit.id),
                                    className: `flex items-center gap-3 p-4 rounded-xl border transition-all h-full ${habit.completed ? 'bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 opacity-60' : 'bg-white dark:bg-zinc-950 border-zinc-100 dark:border-zinc-800 hover:border-indigo-500/30'}`
                                },
                                    React.createElement("div", { className: `w-12 h-12 rounded-full flex items-center justify-center transition-colors shrink-0 ${habit.completed ? 'bg-zinc-200 dark:bg-zinc-800 text-zinc-500' : habit.color}` },
                                        habit.completed ? React.createElement(CheckCircle2, { size: 20 }) : React.createElement(habit.icon, { size: 20 })
                                    ),
                                    React.createElement("div", { className: "flex flex-col items-start flex-1 min-w-0" },
                                        React.createElement("span", { className: "text-[10px] text-zinc-400 uppercase tracking-wider font-bold mb-1" }, habit.category),
                                        React.createElement("span", { className: `text-sm font-bold text-left leading-tight ${habit.completed ? 'text-zinc-400 line-through' : 'text-zinc-800 dark:text-zinc-100'}` }, habit.label)
                                    )
                                )
                            ))
                        )
                    )
                ),
                React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider mb-4 flex items-center gap-2" }, React.createElement(Zap, { size: 16 }), " Quick Links"),
                React.createElement("div", { className: "grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4" },
                    React.createElement(QuickLinkButton, { href: "https://my.hope.ac.uk/myhope/public/index.php/Main/index", icon: Building, label: "MyHope", colorClass: "text-rose-600" }),
                    React.createElement(QuickLinkButton, { href: "https://deadline-tracker04.vercel.app/home", icon: Clock, label: "Deadline Tracker", colorClass: "text-red-500" }),
                    React.createElement(QuickLinkButton, { href: "https://www.notion.so/Share-your-thoughts-2dee1ae8ad32809da202e904f0055734", icon: PenTool, label: "Journal", colorClass: "text-zinc-900 dark:text-zinc-100" }),
                    React.createElement(QuickLinkButton, { href: "https://www.notion.so/My-Library-2e2e1ae8ad3280e58b5dc6521ae118a8", icon: BookOpen, label: "Book Library", colorClass: "text-amber-600" }),
                    React.createElement(QuickLinkButton, { href: "https://www.notion.so/LIFE-GOALS-8a897b99c6a24eac89c1dade55f55761", icon: Target, label: "Life Goals", colorClass: "text-rose-500" }),
                    React.createElement(QuickLinkButton, { href: "https://mtukso03.teleopticloud.com/Web/MyTime#Schedule", icon: Briefcase, label: "Work Schedule", colorClass: "text-cyan-600" }),
                    React.createElement(QuickLinkButton, { href: "https://www.bible.com/users/Ololadeobaji100/reading-plans/65489-the-bible-with-nicky-and-pippa-gumbel-classic/subscription/1238596809/day/1/segment/1", icon: Book, label: "Bible", colorClass: "text-amber-800 dark:text-amber-400" }),
                    React.createElement(QuickLinkButton, { href: "https://calendar.google.com/calendar/u/0/r?pli=1", icon: CalendarIcon, label: "Google Calendar", colorClass: "text-blue-400" }),
                    React.createElement(QuickLinkButton, { href: "https://www.notion.so/Knowledge-Vaults-277e1ae8ad3280b8b2c4e644b1aee2cd", icon: Database, label: "Knowledge Vaults", colorClass: "text-emerald-500" }),
                     React.createElement("button", { onClick: () => onNavigate('tools'), className: "flex flex-col items-center justify-center gap-2 p-3 rounded-xl border-2 border-dashed border-zinc-200 dark:border-zinc-800 text-zinc-400 hover:text-indigo-500 hover:border-indigo-500/50 hover:bg-indigo-50/10 transition-all h-full" },
                        React.createElement(Plus, { size: 16 }),
                        React.createElement("span", { className: "text-xs font-medium" }, "More Tools")
                    )
                )
             );
        };

        const FocusView = () => {
            const [timeLeft, setTimeLeft] = useState(600); // Default 10 minutes
            const [isActive, setIsActive] = useState(false);
            const [initialTime, setInitialTime] = useState(600);
            const [task, setTask] = useState('');
            
            // Audio State
            const [activeSound, setActiveSound] = useState(null);
            const [isPlayingSound, setIsPlayingSound] = useState(false);
            const audioRef = useRef(new Audio());

            const sounds = [
                { id: 'rain', label: 'Rain', icon: CloudRain, url: 'https://actions.google.com/sounds/v1/weather/rain_heavy_loud.ogg' },
                { id: 'forest', label: 'Forest', icon: CloudSun, url: 'https://actions.google.com/sounds/v1/ambiences/forest_morning.ogg' },
                { id: 'fire', label: 'Fire', icon: Flame, url: 'https://actions.google.com/sounds/v1/ambiences/fire.ogg' },
                { id: 'cafe', label: 'Cafe', icon: Coffee, url: 'https://actions.google.com/sounds/v1/ambiences/coffee_shop.ogg' }
            ];

            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => {
                        setTimeLeft(timeLeft => timeLeft - 1);
                    }, 1000);
                } else if (timeLeft === 0) {
                    setIsActive(false);
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            // Cleanup audio on unmount
            useEffect(() => {
                return () => {
                    audioRef.current.pause();
                    audioRef.current.src = "";
                };
            }, []);

            const toggleSound = (sound) => {
                if (activeSound === sound.id) {
                    if (isPlayingSound) {
                        audioRef.current.pause();
                        setIsPlayingSound(false);
                    } else {
                        // Handle play promise rejection
                        audioRef.current.play().catch(e => {
                            console.error("Audio playback failed:", e);
                            setIsPlayingSound(false);
                        });
                        setIsPlayingSound(true);
                    }
                } else {
                    audioRef.current.pause();
                    audioRef.current.src = sound.url;
                    audioRef.current.loop = true;
                    audioRef.current.volume = 0.5;
                    // Handle play promise rejection
                    audioRef.current.play().catch(e => {
                        console.error("Audio playback failed:", e);
                        setIsPlayingSound(false);
                        setActiveSound(null);
                    });
                    setActiveSound(sound.id);
                    setIsPlayingSound(true);
                }
            };

            const toggleTimer = () => setIsActive(!isActive);
            const resetTimer = () => {
                setIsActive(false);
                setTimeLeft(initialTime);
            };
            const setTime = (minutes) => {
                const seconds = minutes * 60;
                setInitialTime(seconds);
                setTimeLeft(seconds);
                setIsActive(false);
            };

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            const progress = ((initialTime - timeLeft) / initialTime) * 100;

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-8" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Focus Mode ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(Timer, { size: 12 }), " Live")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Embrace the 10-minute rule to overcome procrastination.")
                    )
                ),
                React.createElement("div", { className: "flex-1 flex flex-col items-center justify-center min-h-[400px]" },
                    React.createElement("div", { className: "relative mb-12 group" },
                        React.createElement("svg", { className: "w-80 h-80 transform -rotate-90" },
                            React.createElement("circle", { cx: "160", cy: "160", r: "150", stroke: "currentColor", strokeWidth: "8", fill: "transparent", className: "text-zinc-200 dark:text-zinc-800" }),
                            React.createElement("circle", { cx: "160", cy: "160", r: "150", stroke: "currentColor", strokeWidth: "8", fill: "transparent", strokeDasharray: 2 * Math.PI * 150, strokeDashoffset: 2 * Math.PI * 150 * (1 - progress / 100), className: "text-indigo-600 transition-all duration-1000 ease-linear" })
                        ),
                        React.createElement("div", { className: "absolute inset-0 flex flex-col items-center justify-center" },
                            React.createElement("span", { className: "text-7xl font-mono font-bold tracking-tighter text-zinc-900 dark:text-zinc-100" }, formatTime(timeLeft)),
                            React.createElement("input", { 
                                type: "text", 
                                placeholder: "What are you focusing on?", 
                                value: task,
                                onChange: (e) => setTask(e.target.value),
                                className: "mt-4 text-center bg-transparent border-b border-transparent hover:border-zinc-300 focus:border-indigo-500 focus:outline-none text-zinc-500 text-sm w-48 transition-colors placeholder:text-zinc-400"
                            })
                        )
                    ),
                    React.createElement("div", { className: "flex gap-4 mb-12" },
                        React.createElement("button", { onClick: toggleTimer, className: "w-16 h-16 rounded-full flex items-center justify-center bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg shadow-indigo-500/30 transition-all hover:scale-110" },
                            isActive ? React.createElement(Pause, { size: 28, fill: "currentColor" }) : React.createElement(Play, { size: 28, fill: "currentColor", className: "ml-1" })
                        ),
                        React.createElement("button", { onClick: resetTimer, className: "w-16 h-16 rounded-full flex items-center justify-center bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-all" },
                            React.createElement(RotateCcw, { size: 24 })
                        )
                    ),
                    React.createElement("div", { className: "grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-2xl mb-8" },
                        React.createElement("button", { onClick: () => setTime(10), className: `px-6 py-3 rounded-xl border-2 transition-all font-medium ${initialTime === 600 ? 'border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300' : 'border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 text-zinc-500'}` }, "10 Min Rule"),
                        React.createElement("button", { onClick: () => setTime(25), className: `px-6 py-3 rounded-xl border-2 transition-all font-medium ${initialTime === 1500 ? 'border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300' : 'border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 text-zinc-500'}` }, "Pomodoro"),
                        React.createElement("button", { onClick: () => setTime(5), className: `px-6 py-3 rounded-xl border-2 transition-all font-medium ${initialTime === 300 ? 'border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300' : 'border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 text-zinc-500'}` }, "Quick 5"),
                        React.createElement("button", { onClick: () => setTime(60), className: `px-6 py-3 rounded-xl border-2 transition-all font-medium ${initialTime === 3600 ? 'border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300' : 'border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 text-zinc-500'}` }, "Deep Hour")
                    ),
                    React.createElement("div", { className: "w-full max-w-2xl" },
                        React.createElement("div", { className: "flex items-center gap-2 mb-4 text-xs font-semibold uppercase tracking-wider text-zinc-500" }, React.createElement(Volume2, { size: 14 }), " Ambient Soundscapes"),
                        React.createElement("div", { className: "grid grid-cols-2 md:grid-cols-4 gap-4" },
                            sounds.map(sound => (
                                React.createElement("button", { 
                                    key: sound.id,
                                    onClick: () => toggleSound(sound),
                                    className: `flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${activeSound === sound.id ? (isPlayingSound ? 'border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400' : 'border-zinc-400 bg-zinc-100 dark:bg-zinc-800 text-zinc-600') : 'border-zinc-200 dark:border-zinc-800 hover:border-indigo-500/50 text-zinc-500 hover:bg-zinc-50 dark:hover:bg-zinc-800/50'}`
                                },
                                    React.createElement(sound.icon, { size: 18, className: activeSound === sound.id && isPlayingSound ? 'animate-pulse' : '' }),
                                    React.createElement("span", { className: "text-sm font-medium" }, sound.label),
                                    activeSound === sound.id && isPlayingSound && React.createElement("div", { className: "ml-auto w-2 h-2 rounded-full bg-emerald-500" })
                                )
                            ))
                        )
                    )
                )
            );
        };

        const ToolsView = () => (
            React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-8" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Toolbox ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(Wrench, { size: 12 }), " Essentials")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Leverage technology to amplify your output.")
                    ),
                    React.createElement("button", { className: "flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors shadow-lg shadow-indigo-500/20" }, React.createElement(Plus, { size: 16 }), " Add Tool")
                ),
                React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-20" },
                    // Productivity
                    React.createElement(Card, { title: "Productivity HQ", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                            React.createElement(QuickLinkButton, { href: "https://chat.openai.com/", icon: Brain, label: "ChatGPT", colorClass: "text-emerald-500" }),
                            React.createElement(QuickLinkButton, { href: "https://www.notion.so/", icon: Layers, label: "Notion", colorClass: "text-zinc-900 dark:text-zinc-100" }),
                            React.createElement(QuickLinkButton, { href: "https://calendar.google.com/", icon: CalendarIcon, label: "G-Cal", colorClass: "text-blue-500" })
                        )
                    ),
                    // Finance
                    React.createElement(Card, { title: "Finance & Wealth", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                             React.createElement(QuickLinkButton, { href: "https://www.ynab.com/", icon: DollarSign, label: "YNAB", colorClass: "text-blue-600" }),
                             React.createElement(QuickLinkButton, { href: "https://wise.com/", icon: RefreshCw, label: "Wise", colorClass: "text-green-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.tradingview.com/", icon: TrendingUp, label: "TradingView", colorClass: "text-zinc-900 dark:text-zinc-100" }),
                             React.createElement(QuickLinkButton, { href: "https://stripe.com/", icon: CreditCard, label: "Stripe", colorClass: "text-indigo-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.coinbase.com/", icon: Coins, label: "Coinbase", colorClass: "text-blue-400" })
                        )
                    ),
                     // Learning
                     React.createElement(Card, { title: "Knowledge Growth", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                             React.createElement(QuickLinkButton, { href: "https://www.coursera.org/", icon: GraduationCap, label: "Coursera", colorClass: "text-blue-600" }),
                             React.createElement(QuickLinkButton, { href: "https://www.blinkist.com/", icon: BookOpen, label: "Blinkist", colorClass: "text-emerald-500" }),
                             React.createElement(QuickLinkButton, { href: "https://apps.ankiweb.net/", icon: Layers, label: "Anki", colorClass: "text-zinc-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.goodreads.com/", icon: Book, label: "Goodreads", colorClass: "text-amber-700" }),
                             React.createElement(QuickLinkButton, { href: "https://en.wikipedia.org/wiki/Main_Page", icon: Search, label: "Wikipedia", colorClass: "text-zinc-500" })
                        )
                    ),
                    // Creative
                    React.createElement(Card, { title: "Creative Suite", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                             React.createElement(QuickLinkButton, { href: "https://www.figma.com/", icon: PenTool, label: "Figma", colorClass: "text-purple-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.canva.com/", icon: Palette, label: "Canva", colorClass: "text-cyan-500" }),
                             React.createElement(QuickLinkButton, { href: "https://unsplash.com/", icon: Image, label: "Unsplash", colorClass: "text-zinc-900 dark:text-zinc-100" }),
                             React.createElement(QuickLinkButton, { href: "https://coolors.co/", icon: Palette, label: "Coolors", colorClass: "text-blue-400" }),
                             React.createElement(QuickLinkButton, { href: "https://excalidraw.com/", icon: Edit3, label: "Excalidraw", colorClass: "text-purple-400" })
                        )
                    ),
                    // Health
                    React.createElement(Card, { title: "Health & Mind", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                             React.createElement(QuickLinkButton, { href: "https://www.headspace.com/", icon: Sun, label: "Headspace", colorClass: "text-orange-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.myfitnesspal.com/", icon: Heart, label: "MyFitnessPal", colorClass: "text-blue-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.strava.com/", icon: Activity, label: "Strava", colorClass: "text-orange-600" }),
                             React.createElement(QuickLinkButton, { href: "https://www.sleepcycle.com/", icon: Moon, label: "SleepCycle", colorClass: "text-indigo-500" })
                        )
                    ),
                    // Utilities
                    React.createElement(Card, { title: "Utilities", className: "gap-4" },
                        React.createElement("div", { className: "grid grid-cols-3 gap-3" },
                             React.createElement(QuickLinkButton, { href: "https://www.remove.bg/", icon: Scissors, label: "Remove.bg", colorClass: "text-zinc-500" }),
                             React.createElement(QuickLinkButton, { href: "https://tinypng.com/", icon: Image, label: "TinyPNG", colorClass: "text-green-500" }),
                             React.createElement(QuickLinkButton, { href: "https://www.speedtest.net/", icon: Wifi, label: "Speedtest", colorClass: "text-zinc-400" }),
                             React.createElement(QuickLinkButton, { href: "https://wetransfer.com/", icon: Share2, label: "WeTransfer", colorClass: "text-blue-400" }),
                             React.createElement(QuickLinkButton, { href: "https://10minutemail.com/", icon: Mail, label: "10MinMail", colorClass: "text-red-400" }),
                             React.createElement(QuickLinkButton, { href: "https://archive.org/", icon: Archive, label: "Wayback", colorClass: "text-zinc-600" })
                        )
                    )
                )
            )
        );

        const WorriesView = ({ worries, onAddWorry, onDeleteWorry }) => {
            const [input, setInput] = useState("");

            const handleKeyDown = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    if (input.trim()) {
                        onAddWorry(input);
                        setInput("");
                    }
                }
            };

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-8" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Worry Vault ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(ShieldAlert, { size: 12 }), " Secure")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Externalize your anxieties. Naming them is the first step to resolving them.")
                    )
                ),
                React.createElement("div", { className: "flex-1 overflow-y-auto mb-4 space-y-4 pr-2" },
                    worries.length === 0 && React.createElement("div", { className: "flex flex-col items-center justify-center h-64 text-zinc-400" },
                        React.createElement(ShieldQuestion, { size: 48, className: "mb-4 opacity-20" }),
                        React.createElement("p", null, "The vault is empty. Your mind is clear.")
                    ),
                    worries.map(worry => (
                        React.createElement("div", { key: worry.id, className: "group relative bg-orange-50 dark:bg-zinc-900/50 border border-orange-100 dark:border-zinc-800 p-4 rounded-xl flex gap-4 transition-all hover:border-orange-200 dark:hover:border-zinc-700" },
                            React.createElement("div", { className: "mt-1.5 w-2 h-2 rounded-full bg-orange-400 shrink-0" }),
                            React.createElement("p", { className: "text-zinc-700 dark:text-zinc-300 whitespace-pre-wrap leading-relaxed flex-1" }, worry.text),
                            React.createElement("button", { onClick: () => onDeleteWorry(worry.id), className: "absolute top-4 right-4 text-zinc-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity" }, React.createElement(Trash, { size: 16 }))
                        )
                    ))
                ),
                React.createElement("div", { className: "relative" },
                    React.createElement("textarea", {
                        value: input,
                        onChange: (e) => setInput(e.target.value),
                        onKeyDown: handleKeyDown,
                        placeholder: "What is weighing on your mind? (Press Enter to deposit)",
                        className: "w-full bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 pr-12 resize-none focus:outline-none focus:ring-2 focus:ring-orange-500/50 transition-all min-h-[100px]"
                    }),
                    React.createElement("button", { onClick: () => { if(input.trim()) { onAddWorry(input); setInput(""); } }, className: "absolute bottom-4 right-4 p-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors" },
                        React.createElement(ArrowRight, { size: 20 })
                    )
                )
            );
        };

        const FoodView = ({ meals, onUpdateMeal }) => {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const types = ['Breakfast', 'Lunch', 'Dinner', 'Snack'];
            const [viewMode, setViewMode] = useState('day');
            
            // Correctly map JS getDay() (0=Sun, 1=Mon) to our array index (0=Mon, 6=Sun)
            const todayIndex = (new Date().getDay() + 6) % 7;
            const [activeDayIndex, setActiveDayIndex] = useState(todayIndex);

            const getMeal = (day, type) => {
                const userMeal = meals.find(m => m.day === day && m.type === type);
                if (userMeal) return userMeal.text;
                const defaultMeal = DEFAULT_MEALS.find(m => m.day === day && m.type === type);
                return defaultMeal ? defaultMeal.text : "";
            };

            const getTypeColor = (type) => {
                switch(type) {
                    case 'Breakfast': return 'text-orange-500 bg-orange-50 dark:bg-orange-900/10';
                    case 'Lunch': return 'text-blue-500 bg-blue-50 dark:bg-blue-900/10';
                    case 'Dinner': return 'text-indigo-500 bg-indigo-50 dark:bg-indigo-900/10';
                    default: return 'text-emerald-500 bg-emerald-50 dark:bg-emerald-900/10';
                }
            };

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                // Header & View Toggle
                React.createElement("div", { className: "flex justify-between items-center mb-6" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Nutrition Protocol ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(Utensils, { size: 12 }), " Fuel")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Plan your fuel for peak performance.")
                    ),
                    React.createElement("div", { className: "flex p-1 bg-zinc-100 dark:bg-zinc-800 rounded-lg" },
                        React.createElement("button", { 
                            onClick: () => setViewMode('day'),
                            className: `px-4 py-1.5 text-sm font-medium rounded-md transition-all ${viewMode === 'day' ? 'bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100' : 'text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-300'}`
                        }, "Day"),
                        React.createElement("button", { 
                            onClick: () => setViewMode('week'),
                            className: `px-4 py-1.5 text-sm font-medium rounded-md transition-all ${viewMode === 'week' ? 'bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100' : 'text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-300'}`
                        }, "Week")
                    )
                ),

                viewMode === 'day' ? (
                    // Day View
                    React.createElement("div", { className: "flex-1 overflow-y-auto" },
                        // Day Navigator
                        React.createElement("div", { className: "flex items-center justify-between mb-6 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-3 rounded-xl" },
                            React.createElement("button", { onClick: () => setActiveDayIndex((prev) => (prev - 1 + 7) % 7), className: "p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-zinc-500 transition-colors" }, React.createElement(ChevronLeft, { size: 20 })),
                            React.createElement("span", { className: "font-bold text-xl text-zinc-800 dark:text-zinc-100 w-32 text-center" }, days[activeDayIndex]),
                            React.createElement("button", { onClick: () => setActiveDayIndex((prev) => (prev + 1) % 7), className: "p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-zinc-500 transition-colors" }, React.createElement(ChevronRight, { size: 20 }))
                        ),
                        // Meal Cards
                        React.createElement("div", { className: "grid grid-cols-1 gap-4 pb-4" },
                            types.map(type => (
                                React.createElement("div", { key: type, className: "bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-6 rounded-2xl shadow-sm hover:border-emerald-500/30 transition-all" },
                                    React.createElement("div", { className: "flex items-center gap-2 mb-3" },
                                        React.createElement("span", { className: `px-2 py-1 rounded text-xs font-bold uppercase tracking-wider ${getTypeColor(type)}` }, type)
                                    ),
                                    React.createElement("textarea", {
                                        value: getMeal(days[activeDayIndex], type),
                                        onChange: (e) => onUpdateMeal(days[activeDayIndex], type, e.target.value),
                                        className: "w-full h-24 bg-transparent border-0 resize-none text-lg text-zinc-800 dark:text-zinc-200 placeholder:text-zinc-400 focus:ring-0 p-0 font-medium leading-relaxed",
                                        placeholder: `What's for ${type.toLowerCase()}?`
                                    })
                                )
                            ))
                        )
                    )
                ) : (
                    // Week View
                    React.createElement("div", { className: "flex-1 overflow-y-auto space-y-6 pr-2 pb-4" },
                        days.map(day => (
                            React.createElement("div", { key: day, className: "bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl overflow-hidden" },
                                React.createElement("div", { className: "px-6 py-3 bg-zinc-50 dark:bg-zinc-950/50 border-b border-zinc-100 dark:border-zinc-800 font-bold text-zinc-700 dark:text-zinc-300" }, day),
                                React.createElement("div", { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 divide-y sm:divide-y-0 sm:divide-x border-zinc-100 dark:border-zinc-800 dark:divide-zinc-800" },
                                    types.map(type => (
                                        React.createElement("div", { key: type, className: "p-4" },
                                            React.createElement("div", { className: "text-[10px] font-bold text-zinc-400 uppercase tracking-wider mb-2" }, type),
                                            React.createElement("textarea", {
                                                value: getMeal(day, type),
                                                onChange: (e) => onUpdateMeal(day, type, e.target.value),
                                                className: "w-full bg-transparent resize-none text-sm text-zinc-700 dark:text-zinc-300 focus:outline-none min-h-[60px] leading-snug",
                                                rows: 3,
                                                placeholder: "-"
                                            })
                                        )
                                    ))
                                )
                            )
                        ))
                    )
                )
            );
        };

        const BrainDumpView = ({ dumps, onAddDump, onDeleteDump }) => {
            const [input, setInput] = useState("");

            const handleKeyDown = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    if (input.trim()) {
                        onAddDump(input);
                        setInput("");
                    }
                }
            };

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-8" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Brain Dump ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(FileText, { size: 12 }), " Log")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Clear your mind. Capture everything here.")
                    )
                ),
                React.createElement("div", { className: "flex-1 overflow-y-auto mb-4 space-y-4 pr-2" },
                    dumps.length === 0 && React.createElement("div", { className: "flex flex-col items-center justify-center h-64 text-zinc-400" },
                        React.createElement(FileText, { size: 48, className: "mb-4 opacity-20" }),
                        React.createElement("p", null, "No entries yet. Start typing below.")
                    ),
                    dumps.map(dump => (
                        React.createElement("div", { key: dump.id, className: "group relative bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-4 rounded-xl flex gap-4 transition-all hover:border-zinc-300 dark:hover:border-zinc-700" },
                            React.createElement("div", { className: "mt-1.5 w-2 h-2 rounded-full bg-zinc-300 dark:bg-zinc-700 shrink-0" }),
                            React.createElement("p", { className: "text-zinc-700 dark:text-zinc-300 whitespace-pre-wrap leading-relaxed flex-1" }, dump.text),
                            React.createElement("button", { onClick: () => onDeleteDump(dump.id), className: "absolute top-4 right-4 text-zinc-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity" }, React.createElement(Trash, { size: 16 }))
                        )
                    ))
                ),
                React.createElement("div", { className: "relative" },
                    React.createElement("textarea", {
                        value: input,
                        onChange: (e) => setInput(e.target.value),
                        onKeyDown: handleKeyDown,
                        placeholder: "Type whatever is on your mind... (Press Enter to save)",
                        className: "w-full bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 pr-12 resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all min-h-[100px]"
                    }),
                    React.createElement("button", { onClick: () => { if(input.trim()) { onAddDump(input); setInput(""); } }, className: "absolute bottom-4 right-4 p-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors" },
                        React.createElement(ArrowRight, { size: 20 })
                    )
                )
            );
        };

        const BrainstormView = ({ notes, onAddNote, onUpdateNote, onDeleteNote }) => {
            const [mode, setMode] = useState('pointer'); 
            const [paths, setPaths] = useState([]);
            const [currentPath, setCurrentPath] = useState([]);
            const [isDrawing, setIsDrawing] = useState(false);
            const [draggingNote, setDraggingNote] = useState(null);
            const canvasRef = useRef(null);

            const createNewNote = (x, y) => {
                const colors = ["bg-amber-100 dark:bg-amber-900 text-amber-900 dark:text-amber-100", "bg-rose-100 dark:bg-rose-900 text-rose-900 dark:text-rose-100", "bg-blue-100 dark:bg-blue-900 text-blue-900 dark:text-blue-100", "bg-emerald-100 dark:bg-emerald-900 text-emerald-900 dark:text-emerald-100"];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                onAddNote({ x, y, text: "New Idea", color: randomColor });
            };

            const addNoteCenter = () => {
                if (!canvasRef.current) return;
                const rect = canvasRef.current.getBoundingClientRect();
                createNewNote(Math.max(0, rect.width / 2 - 128), Math.max(0, rect.height / 2 - 64));
            };

            const handleNoteMouseDown = (e, noteId) => {
                if (mode === 'draw') return;
                e.stopPropagation();
                const note = notes.find(n => n.id === noteId);
                setDraggingNote({ id: noteId, startX: e.clientX, startY: e.clientY, initialX: note.x, initialY: note.y });
            };

            const handleCanvasDoubleClick = (e) => {
                if (mode === 'draw' || (e.target !== canvasRef.current && e.target.tagName !== 'svg')) return;
                createNewNote(e.nativeEvent.offsetX - 100, e.nativeEvent.offsetY - 50);
            };

            const handleCanvasMouseDown = (e) => {
                if (mode === 'draw') {
                    setIsDrawing(true);
                    setCurrentPath([{ x: e.nativeEvent.offsetX, y: e.nativeEvent.offsetY }]);
                }
            };

            const handleCanvasMouseMove = (e) => {
                if (draggingNote && mode === 'pointer') {
                    const dx = e.clientX - draggingNote.startX;
                    const dy = e.clientY - draggingNote.startY;
                    onUpdateNote(draggingNote.id, { x: draggingNote.initialX + dx, y: draggingNote.initialY + dy });
                }
                if (isDrawing && mode === 'draw') {
                    setCurrentPath(prev => [...prev, { x: e.nativeEvent.offsetX, y: e.nativeEvent.offsetY }]);
                }
            };

            const handleCanvasMouseUp = () => {
                if (draggingNote) setDraggingNote(null);
                if (isDrawing) {
                    setIsDrawing(false);
                    if (currentPath.length > 1) setPaths(prev => [...prev, currentPath]);
                    setCurrentPath([]);
                }
            };

            const clearCanvas = () => { if (confirm("Clear all drawings? Notes will remain.")) setPaths([]); };
            const pointsToPath = (points) => points.length === 0 ? '' : points.reduce((acc, point, i) => acc + (i === 0 ? `M ${point.x} ${point.y}` : ` L ${point.x} ${point.y}`), '');

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-4" },
                    React.createElement("div", null,
                        React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "Brainstorm ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(Sparkles, { size: 12 }), " Canvas")),
                        React.createElement("p", { className: "text-zinc-500 text-sm" }, "Free-form thinking. Double click or use + to add notes.")
                    ),
                    React.createElement("div", { className: "flex gap-2 p-1 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl shadow-sm" },
                        React.createElement("button", { onClick: addNoteCenter, className: "p-2 rounded-lg transition-all text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 hover:text-indigo-600" }, React.createElement(Plus, { size: 18 })),
                        React.createElement("div", { className: "w-[1px] bg-zinc-200 dark:bg-zinc-800 mx-1" }),
                        React.createElement("button", { onClick: () => setMode('pointer'), className: `p-2 rounded-lg transition-all flex items-center gap-2 ${mode === 'pointer' ? 'bg-indigo-600 text-white shadow-md' : 'text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800'}` }, React.createElement(MousePointer2, { size: 18 })),
                        React.createElement("button", { onClick: () => setMode('draw'), className: `p-2 rounded-lg transition-all flex items-center gap-2 ${mode === 'draw' ? 'bg-indigo-600 text-white shadow-md' : 'text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800'}` }, React.createElement(PenTool, { size: 18 })),
                        React.createElement("div", { className: "w-[1px] bg-zinc-200 dark:bg-zinc-800 mx-1" }),
                        React.createElement("button", { onClick: clearCanvas, className: "p-2 text-zinc-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors" }, React.createElement(Eraser, { size: 18 }))
                    )
                ),
                React.createElement("div", { className: "flex-1 relative rounded-3xl border border-zinc-200 dark:border-zinc-800 bg-zinc-50/50 dark:bg-zinc-950/50 overflow-hidden shadow-inner min-h-[600px]" },
                    React.createElement("div", { className: "absolute inset-0 opacity-[0.3] dark:opacity-[0.1] pointer-events-none", style: { backgroundImage: 'radial-gradient(#94a3b8 1px, transparent 1px)', backgroundSize: '24px 24px' } }),
                    React.createElement("div", { 
                        ref: canvasRef,
                        className: `absolute inset-0 w-full h-full ${mode === 'pointer' ? 'cursor-default' : 'cursor-crosshair'}`,
                        onDoubleClick: handleCanvasDoubleClick,
                        onMouseDown: handleCanvasMouseDown,
                        onMouseMove: handleCanvasMouseMove,
                        onMouseUp: handleCanvasMouseUp,
                        onMouseLeave: handleCanvasMouseUp
                    },
                        React.createElement("svg", { className: "absolute inset-0 w-full h-full pointer-events-none z-0" },
                            paths.map((path, i) => React.createElement("path", { key: i, d: pointsToPath(path), stroke: "currentColor", strokeWidth: "3", fill: "none", className: "text-zinc-400 dark:text-zinc-600 opacity-80", strokeLinecap: "round", strokeLinejoin: "round" })),
                            currentPath.length > 0 && React.createElement("path", { d: pointsToPath(currentPath), stroke: "currentColor", strokeWidth: "3", fill: "none", className: "text-indigo-500 opacity-80", strokeLinecap: "round", strokeLinejoin: "round" })
                        ),
                        notes.map(note => (
                            React.createElement("div", {
                                key: note.id,
                                onMouseDown: (e) => handleNoteMouseDown(e, note.id),
                                style: { left: note.x, top: note.y, transform: draggingNote?.id === note.id ? 'scale(1.02)' : 'scale(1)', zIndex: draggingNote?.id === note.id ? 50 : 10 },
                                className: `absolute w-64 p-4 rounded-xl shadow-sm border border-black/5 dark:border-white/5 ${note.color} ${mode === 'pointer' ? 'cursor-grab active:cursor-grabbing' : ''} group transition-transform`
                            },
                                React.createElement("div", { className: "flex justify-between items-start mb-2 opacity-50 group-hover:opacity-100 transition-opacity" },
                                    React.createElement(Move, { size: 12 }),
                                    React.createElement("button", { onClick: (e) => { e.stopPropagation(); onDeleteNote(note.id); }, className: "hover:text-red-500" }, React.createElement(Trash2, { size: 12 }))
                                ),
                                React.createElement("textarea", {
                                    value: note.text,
                                    onChange: (e) => onUpdateNote(note.id, { text: e.target.value }),
                                    onMouseDown: (e) => e.stopPropagation(),
                                    onDoubleClick: (e) => e.stopPropagation(),
                                    className: "w-full bg-transparent border-none resize-none focus:ring-0 p-0 text-sm font-medium font-handwriting leading-relaxed h-24",
                                    placeholder: "Write something..."
                                })
                            )
                        ))
                    )
                )
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [darkMode, setDarkMode] = useState(true);
            const [user, setUser] = useState(null);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [authError, setAuthError] = useState(null);
            const [userIdentity, setUserIdentity] = useState('main');
            
            const [notes, setNotes] = useState([]); 
            const [dumps, setDumps] = useState([]);
            const [meals, setMeals] = useState([]);
            const [worries, setWorries] = useState([]);

            useEffect(() => {
                if(darkMode) document.documentElement.classList.add('dark');
                else document.documentElement.classList.remove('dark');
            }, [darkMode]);

            useEffect(() => {
                if (isFirebaseConfigured) {
                    const unsubscribe = onAuthStateChanged(auth, (u) => {
                        setUser(u);
                        if (u) setAuthError(null);
                    });

                    const initAuth = async () => {
                        try {
                            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                await signInWithCustomToken(auth, __initial_auth_token);
                            } else {
                                await signInAnonymously(auth);
                            }
                        } catch (e) {
                            if (e.code === 'auth/configuration-not-found' || e.code === 'auth/operation-not-allowed') {
                                console.warn("App running in Offline Mode: Anonymous Auth is disabled in Firebase Console.");
                            } else {
                                console.error("Auth Initialization Error:", e);
                            }
                            setAuthError(e.message);
                        }
                    };

                    if (!auth.currentUser) {
                        initAuth();
                    }
                    return () => unsubscribe();
                }
            }, []);

            useEffect(() => {
                if (!isFirebaseConfigured || !user || !userIdentity) return;

                const userPath = `user_${userIdentity}`;

                // Sync Brainstorm Notes
                const qNotes = query(
                    collection(db, 'artifacts', appId, 'users', userPath, 'brainstorm_notes'),
                    orderBy('createdAt', 'asc')
                );
                const unsubNotes = onSnapshot(qNotes, (snapshot) => {
                    setNotes(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => console.error(`Error fetching brainstorm_notes:`, error));

                // Sync Brain Dumps
                const qDumps = query(
                    collection(db, 'artifacts', appId, 'users', userPath, 'brain_dumps'),
                    orderBy('createdAt', 'desc')
                );
                const unsubDumps = onSnapshot(qDumps, (snapshot) => {
                    setDumps(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => console.error(`Error fetching brain_dumps:`, error));

                // Sync Meals
                const qMeals = query(collection(db, 'artifacts', appId, 'users', userPath, 'meals'));
                const unsubMeals = onSnapshot(qMeals, (snapshot) => {
                    setMeals(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => console.error(`Error fetching meals:`, error));

                // Sync Worries
                const qWorries = query(
                    collection(db, 'artifacts', appId, 'users', userPath, 'worries'),
                    orderBy('createdAt', 'desc')
                );
                const unsubWorries = onSnapshot(qWorries, (snapshot) => {
                    setWorries(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                }, (error) => console.error(`Error fetching worries:`, error));

                return () => { unsubNotes(); unsubDumps(); unsubMeals(); unsubWorries(); };
            }, [user, authError, userIdentity]);

            const getSafeUserPath = () => userIdentity ? `user_${userIdentity}` : null;

            // Handlers
            const handleAddNote = async (note) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await addDoc(collection(db, 'artifacts', appId, 'users', path, 'brainstorm_notes'), { ...note, createdAt: serverTimestamp() });
                else setNotes([...notes, { id: Date.now(), ...note }]);
            };
            const handleUpdateNote = async (id, updates) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await updateDoc(doc(db, 'artifacts', appId, 'users', path, 'brainstorm_notes', id), updates);
                else setNotes(notes.map(n => n.id === id ? { ...n, ...updates } : n));
            };
            const handleDeleteNote = async (id) => {
                 const path = getSafeUserPath();
                 if (isFirebaseConfigured && user && path) await deleteDoc(doc(db, 'artifacts', appId, 'users', path, 'brainstorm_notes', id));
                 else setNotes(notes.filter(n => n.id !== id));
            };

            const handleAddDump = async (text) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await addDoc(collection(db, 'artifacts', appId, 'users', path, 'brain_dumps'), { text, createdAt: serverTimestamp() });
                else setDumps([{id: Date.now(), text}, ...dumps]);
            };
            const handleDeleteDump = async (id) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await deleteDoc(doc(db, 'artifacts', appId, 'users', path, 'brain_dumps', id));
                else setDumps(dumps.filter(d => d.id !== id));
            };

            const handleUpdateMeal = async (day, type, text) => {
                const path = getSafeUserPath();
                const existingMeal = meals.find(m => m.day === day && m.type === type);
                
                if (isFirebaseConfigured && user && path) {
                    if (existingMeal) {
                        await updateDoc(doc(db, 'artifacts', appId, 'users', path, 'meals', existingMeal.id), { text });
                    } else {
                        await addDoc(collection(db, 'artifacts', appId, 'users', path, 'meals'), { day, type, text });
                    }
                } else {
                    if (existingMeal) {
                        setMeals(meals.map(m => m.id === existingMeal.id ? { ...m, text } : m));
                    } else {
                        setMeals([...meals, { id: Date.now(), day, type, text }]);
                    }
                }
            };

            const handleAddWorry = async (text) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await addDoc(collection(db, 'artifacts', appId, 'users', path, 'worries'), { text, createdAt: serverTimestamp() });
                else setWorries([{id: Date.now(), text}, ...worries]);
            };
            const handleDeleteWorry = async (id) => {
                const path = getSafeUserPath();
                if (isFirebaseConfigured && user && path) await deleteDoc(doc(db, 'artifacts', appId, 'users', path, 'worries', id));
                else setWorries(worries.filter(w => w.id !== id));
            };

            const SidebarContent = () => (
                React.createElement(React.Fragment, null,
                    React.createElement("div", { className: "flex items-center gap-3 mb-10 px-2" },
                        React.createElement("div", { className: "w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white shadow-indigo-500/20 shadow-lg" }, React.createElement(Brain, { size: 18 })),
                        React.createElement("h1", { className: "text-xl font-bold tracking-tight" }, "LifeOS")
                    ),
                    React.createElement("nav", { className: "space-y-2 flex-1" },
                        React.createElement(NavItem, { icon: Layout, label: "Dashboard", active: activeTab === 'dashboard', onClick: () => { setActiveTab('dashboard'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: Timer, label: "Focus Mode", active: activeTab === 'focus', onClick: () => { setActiveTab('focus'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: Lightbulb, label: "Brainstorm", active: activeTab === 'brainstorm', onClick: () => { setActiveTab('brainstorm'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: FileText, label: "Brain Dump", active: activeTab === 'braindump', onClick: () => { setActiveTab('braindump'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: ShieldAlert, label: "Worries", active: activeTab === 'worries', onClick: () => { setActiveTab('worries'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: Utensils, label: "Food Plan", active: activeTab === 'food', onClick: () => { setActiveTab('food'); setMobileMenuOpen(false); } }),
                        React.createElement(NavItem, { icon: Wrench, label: "Tools", active: activeTab === 'tools', onClick: () => { setActiveTab('tools'); setMobileMenuOpen(false); } })
                    ),
                    React.createElement("div", { className: "pt-6 border-t border-zinc-200 dark:border-zinc-800 space-y-2" },
                        React.createElement("button", { onClick: () => setDarkMode(!darkMode), className: "w-full flex items-center gap-3 px-4 py-3 rounded-xl text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 transition-colors" },
                            React.createElement(darkMode ? Sun : Moon, { size: 20 }),
                            React.createElement("span", { className: "font-medium" }, darkMode ? "Light Mode" : "Dark Mode")
                        )
                    )
                )
            );

            return React.createElement("div", { className: "min-h-screen bg-zinc-50 dark:bg-zinc-950 text-zinc-900 dark:text-zinc-100 transition-colors duration-300 font-sans selection:bg-indigo-500/30" },
                // Desktop Sidebar
                React.createElement("aside", { className: "fixed left-0 top-0 h-full w-64 border-r border-zinc-200 dark:border-zinc-800 bg-white/50 dark:bg-zinc-950/50 backdrop-blur-xl p-6 hidden md:flex flex-col z-20" },
                    React.createElement(SidebarContent)
                ),
                
                // Mobile Sidebar Overlay & Drawer
                mobileMenuOpen && React.createElement("div", { className: "fixed inset-0 z-50 md:hidden" },
                    React.createElement("div", { className: "absolute inset-0 bg-black/50 backdrop-blur-sm", onClick: () => setMobileMenuOpen(false) }),
                    React.createElement("aside", { className: "absolute left-0 top-0 h-full w-64 bg-white dark:bg-zinc-950 border-r border-zinc-200 dark:border-zinc-800 p-6 flex flex-col shadow-2xl animate-in slide-in-from-left duration-300" },
                        React.createElement(SidebarContent)
                    )
                ),

                React.createElement("main", { className: "md:ml-64 p-4 md:p-12 max-w-7xl mx-auto" },
                    React.createElement("header", { className: "flex justify-between md:justify-end items-center mb-6" },
                        React.createElement("button", { onClick: () => setMobileMenuOpen(true), className: "md:hidden p-2 text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-100" },
                            React.createElement(Menu, { size: 24 })
                        ),

                        React.createElement("div", { className: "flex items-center gap-4" },
                            React.createElement("div", { className: "w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400 font-bold border border-indigo-200 dark:border-indigo-800" }, "LO")
                        )
                    ),
                    activeTab === 'dashboard' && React.createElement(DashboardView, { notes, onAddNote: handleAddNote, onNavigate: setActiveTab, meals }),
                    activeTab === 'focus' && React.createElement(FocusView),
                    activeTab === 'brainstorm' && React.createElement(BrainstormView, { notes, onAddNote: handleAddNote, onUpdateNote: handleUpdateNote, onDeleteNote: handleDeleteNote }),
                    activeTab === 'braindump' && React.createElement(BrainDumpView, { dumps, onAddDump: handleAddDump, onDeleteDump: handleDeleteDump }),
                    activeTab === 'worries' && React.createElement(WorriesView, { worries, onAddWorry: handleAddWorry, onDeleteWorry: handleDeleteWorry }),
                    activeTab === 'food' && React.createElement(FoodView, { meals, onUpdateMeal: handleUpdateMeal }),
                    activeTab === 'tools' && React.createElement(ToolsView),
                    !['dashboard', 'brainstorm', 'tools', 'focus', 'braindump', 'food', 'worries'].includes(activeTab) && React.createElement("div", { className: "flex flex-col items-center justify-center h-[60vh] text-zinc-400" },
                        React.createElement("div", { className: "w-16 h-16 bg-zinc-100 dark:bg-zinc-900 rounded-2xl flex items-center justify-center mb-4" }, React.createElement(PenTool, { size: 32 })),
                        React.createElement("h3", { className: "text-xl font-semibold text-zinc-900 dark:text-zinc-100 mb-2" }, "Work in Progress"),
                        React.createElement("p", null, "This room is currently under construction.")
                    )
                )
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
